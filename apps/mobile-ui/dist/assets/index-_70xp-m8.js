var Yt=Object.defineProperty,qt=Object.defineProperties;var Ut=Object.getOwnPropertyDescriptors;var Ze=Object.getOwnPropertySymbols;var Kt=Object.prototype.hasOwnProperty,Gt=Object.prototype.propertyIsEnumerable;var et=(t,e,s)=>e in t?Yt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,ce=(t,e)=>{for(var s in e||(e={}))Kt.call(e,s)&&et(t,s,e[s]);if(Ze)for(var s of Ze(e))Gt.call(e,s)&&et(t,s,e[s]);return t},We=(t,e)=>qt(t,Ut(e));function zt(t,e){for(var s=0;s<e.length;s++){const u=e[s];if(typeof u!="string"&&!Array.isArray(u)){for(const n in u)if(n!=="default"&&!(n in t)){const f=Object.getOwnPropertyDescriptor(u,n);f&&Object.defineProperty(t,n,f.get?f:{enumerable:!0,get:()=>u[n]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))u(n);new MutationObserver(n=>{for(const f of n)if(f.type==="childList")for(const m of f.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&u(m)}).observe(document,{childList:!0,subtree:!0});function s(n){const f={};return n.integrity&&(f.integrity=n.integrity),n.referrerPolicy&&(f.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?f.credentials="include":n.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function u(n){if(n.ep)return;n.ep=!0;const f=s(n);fetch(n.href,f)}})();var Ee,L,Tt,oe,tt,bt,wt,kt,Ve,Pe,Fe,de={},Rt=[],Vt=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Me=Array.isArray;function ee(t,e){for(var s in e)t[s]=e[s];return t}function Qe(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function Qt(t,e,s){var u,n,f,m={};for(f in e)f=="key"?u=e[f]:f=="ref"?n=e[f]:m[f]=e[f];if(arguments.length>2&&(m.children=arguments.length>3?Ee.call(arguments,2):s),typeof t=="function"&&t.defaultProps!=null)for(f in t.defaultProps)m[f]===void 0&&(m[f]=t.defaultProps[f]);return Se(t,m,u,n,null)}function Se(t,e,s,u,n){var f={type:t,props:e,key:s,ref:u,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:n==null?++Tt:n,__i:-1,__u:0};return n==null&&L.vnode!=null&&L.vnode(f),f}function xe(t){return t.children}function Ae(t,e){this.props=t,this.context=e}function fe(t,e){if(e==null)return t.__?fe(t.__,t.__i+1):null;for(var s;e<t.__k.length;e++)if((s=t.__k[e])!=null&&s.__e!=null)return s.__e;return typeof t.type=="function"?fe(t):null}function Et(t){var e,s;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((s=t.__k[e])!=null&&s.__e!=null){t.__e=t.__c.base=s.__e;break}return Et(t)}}function rt(t){(!t.__d&&(t.__d=!0)&&oe.push(t)&&!we.__r++||tt!=L.debounceRendering)&&((tt=L.debounceRendering)||bt)(we)}function we(){for(var t,e,s,u,n,f,m,o=1;oe.length;)oe.length>o&&oe.sort(wt),t=oe.shift(),o=oe.length,t.__d&&(s=void 0,u=void 0,n=(u=(e=t).__v).__e,f=[],m=[],e.__P&&((s=ee({},u)).__v=u.__v+1,L.vnode&&L.vnode(s),je(e.__P,s,u,e.__n,e.__P.namespaceURI,32&u.__u?[n]:null,f,n==null?fe(u):n,!!(32&u.__u),m),s.__v=u.__v,s.__.__k[s.__i]=s,It(f,s,m),u.__e=u.__=null,s.__e!=n&&Et(s)));we.__r=0}function Mt(t,e,s,u,n,f,m,o,l,a,c){var r,i,h,d,A,p,C,S=u&&u.__k||Rt,b=e.length;for(l=jt(s,e,S,l,b),r=0;r<b;r++)(h=s.__k[r])!=null&&(i=h.__i==-1?de:S[h.__i]||de,h.__i=r,p=je(t,h,i,n,f,m,o,l,a,c),d=h.__e,h.ref&&i.ref!=h.ref&&(i.ref&&Je(i.ref,null,h),c.push(h.ref,h.__c||d,h)),A==null&&d!=null&&(A=d),(C=!!(4&h.__u))||i.__k===h.__k?l=xt(h,l,t,C):typeof h.type=="function"&&p!==void 0?l=p:d&&(l=d.nextSibling),h.__u&=-7);return s.__e=A,l}function jt(t,e,s,u,n){var f,m,o,l,a,c=s.length,r=c,i=0;for(t.__k=new Array(n),f=0;f<n;f++)(m=e[f])!=null&&typeof m!="boolean"&&typeof m!="function"?(l=f+i,(m=t.__k[f]=typeof m=="string"||typeof m=="number"||typeof m=="bigint"||m.constructor==String?Se(null,m,null,null,null):Me(m)?Se(xe,{children:m},null,null,null):m.constructor==null&&m.__b>0?Se(m.type,m.props,m.key,m.ref?m.ref:null,m.__v):m).__=t,m.__b=t.__b+1,o=null,(a=m.__i=Jt(m,s,l,r))!=-1&&(r--,(o=s[a])&&(o.__u|=2)),o==null||o.__v==null?(a==-1&&(n>c?i--:n<c&&i++),typeof m.type!="function"&&(m.__u|=4)):a!=l&&(a==l-1?i--:a==l+1?i++:(a>l?i--:i++,m.__u|=4))):t.__k[f]=null;if(r)for(f=0;f<c;f++)(o=s[f])!=null&&!(2&o.__u)&&(o.__e==u&&(u=fe(o)),Dt(o,o));return u}function xt(t,e,s,u){var n,f;if(typeof t.type=="function"){for(n=t.__k,f=0;n&&f<n.length;f++)n[f]&&(n[f].__=t,e=xt(n[f],e,s,u));return e}t.__e!=e&&(u&&(e&&t.type&&!e.parentNode&&(e=fe(t)),s.insertBefore(t.__e,e||null)),e=t.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function Jt(t,e,s,u){var n,f,m,o=t.key,l=t.type,a=e[s],c=a!=null&&(2&a.__u)==0;if(a===null&&t.key==null||c&&o==a.key&&l==a.type)return s;if(u>(c?1:0)){for(n=s-1,f=s+1;n>=0||f<e.length;)if((a=e[m=n>=0?n--:f++])!=null&&!(2&a.__u)&&o==a.key&&l==a.type)return m}return-1}function nt(t,e,s){e[0]=="-"?t.setProperty(e,s==null?"":s):t[e]=s==null?"":typeof s!="number"||Vt.test(e)?s:s+"px"}function ye(t,e,s,u,n){var f,m;e:if(e=="style")if(typeof s=="string")t.style.cssText=s;else{if(typeof u=="string"&&(t.style.cssText=u=""),u)for(e in u)s&&e in s||nt(t.style,e,"");if(s)for(e in s)u&&s[e]==u[e]||nt(t.style,e,s[e])}else if(e[0]=="o"&&e[1]=="n")f=e!=(e=e.replace(kt,"$1")),m=e.toLowerCase(),e=m in t||e=="onFocusOut"||e=="onFocusIn"?m.slice(2):e.slice(2),t.l||(t.l={}),t.l[e+f]=s,s?u?s.u=u.u:(s.u=Ve,t.addEventListener(e,f?Fe:Pe,f)):t.removeEventListener(e,f?Fe:Pe,f);else{if(n=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in t)try{t[e]=s==null?"":s;break e}catch(o){}typeof s=="function"||(s==null||s===!1&&e[4]!="-"?t.removeAttribute(e):t.setAttribute(e,e=="popover"&&s==1?"":s))}}function at(t){return function(e){if(this.l){var s=this.l[e.type+t];if(e.t==null)e.t=Ve++;else if(e.t<s.u)return;return s(L.event?L.event(e):e)}}}function je(t,e,s,u,n,f,m,o,l,a){var c,r,i,h,d,A,p,C,S,b,g,y,_,w,T,k,E,I=e.type;if(e.constructor!=null)return null;128&s.__u&&(l=!!(32&s.__u),f=[o=e.__e=s.__e]),(c=L.__b)&&c(e);e:if(typeof I=="function")try{if(C=e.props,S="prototype"in I&&I.prototype.render,b=(c=I.contextType)&&u[c.__c],g=c?b?b.props.value:c.__:u,s.__c?p=(r=e.__c=s.__c).__=r.__E:(S?e.__c=r=new I(C,g):(e.__c=r=new Ae(C,g),r.constructor=I,r.render=Zt),b&&b.sub(r),r.props=C,r.state||(r.state={}),r.context=g,r.__n=u,i=r.__d=!0,r.__h=[],r._sb=[]),S&&r.__s==null&&(r.__s=r.state),S&&I.getDerivedStateFromProps!=null&&(r.__s==r.state&&(r.__s=ee({},r.__s)),ee(r.__s,I.getDerivedStateFromProps(C,r.__s))),h=r.props,d=r.state,r.__v=e,i)S&&I.getDerivedStateFromProps==null&&r.componentWillMount!=null&&r.componentWillMount(),S&&r.componentDidMount!=null&&r.__h.push(r.componentDidMount);else{if(S&&I.getDerivedStateFromProps==null&&C!==h&&r.componentWillReceiveProps!=null&&r.componentWillReceiveProps(C,g),!r.__e&&r.shouldComponentUpdate!=null&&r.shouldComponentUpdate(C,r.__s,g)===!1||e.__v==s.__v){for(e.__v!=s.__v&&(r.props=C,r.state=r.__s,r.__d=!1),e.__e=s.__e,e.__k=s.__k,e.__k.some(function(M){M&&(M.__=e)}),y=0;y<r._sb.length;y++)r.__h.push(r._sb[y]);r._sb=[],r.__h.length&&m.push(r);break e}r.componentWillUpdate!=null&&r.componentWillUpdate(C,r.__s,g),S&&r.componentDidUpdate!=null&&r.__h.push(function(){r.componentDidUpdate(h,d,A)})}if(r.context=g,r.props=C,r.__P=t,r.__e=!1,_=L.__r,w=0,S){for(r.state=r.__s,r.__d=!1,_&&_(e),c=r.render(r.props,r.state,r.context),T=0;T<r._sb.length;T++)r.__h.push(r._sb[T]);r._sb=[]}else do r.__d=!1,_&&_(e),c=r.render(r.props,r.state,r.context),r.state=r.__s;while(r.__d&&++w<25);r.state=r.__s,r.getChildContext!=null&&(u=ee(ee({},u),r.getChildContext())),S&&!i&&r.getSnapshotBeforeUpdate!=null&&(A=r.getSnapshotBeforeUpdate(h,d)),k=c,c!=null&&c.type===xe&&c.key==null&&(k=vt(c.props.children)),o=Mt(t,Me(k)?k:[k],e,s,u,n,f,m,o,l,a),r.base=e.__e,e.__u&=-161,r.__h.length&&m.push(r),p&&(r.__E=r.__=null)}catch(M){if(e.__v=null,l||f!=null)if(M.then){for(e.__u|=l?160:128;o&&o.nodeType==8&&o.nextSibling;)o=o.nextSibling;f[f.indexOf(o)]=null,e.__e=o}else{for(E=f.length;E--;)Qe(f[E]);Oe(e)}else e.__e=s.__e,e.__k=s.__k,M.then||Oe(e);L.__e(M,e,s)}else f==null&&e.__v==s.__v?(e.__k=s.__k,e.__e=s.__e):o=e.__e=Xt(s.__e,e,s,u,n,f,m,l,a);return(c=L.diffed)&&c(e),128&e.__u?void 0:o}function Oe(t){t&&t.__c&&(t.__c.__e=!0),t&&t.__k&&t.__k.forEach(Oe)}function It(t,e,s){for(var u=0;u<s.length;u++)Je(s[u],s[++u],s[++u]);L.__c&&L.__c(e,t),t.some(function(n){try{t=n.__h,n.__h=[],t.some(function(f){f.call(n)})}catch(f){L.__e(f,n.__v)}})}function vt(t){return typeof t!="object"||t==null||t.__b&&t.__b>0?t:Me(t)?t.map(vt):ee({},t)}function Xt(t,e,s,u,n,f,m,o,l){var a,c,r,i,h,d,A,p=s.props,C=e.props,S=e.type;if(S=="svg"?n="http://www.w3.org/2000/svg":S=="math"?n="http://www.w3.org/1998/Math/MathML":n||(n="http://www.w3.org/1999/xhtml"),f!=null){for(a=0;a<f.length;a++)if((h=f[a])&&"setAttribute"in h==!!S&&(S?h.localName==S:h.nodeType==3)){t=h,f[a]=null;break}}if(t==null){if(S==null)return document.createTextNode(C);t=document.createElementNS(n,S,C.is&&C),o&&(L.__m&&L.__m(e,f),o=!1),f=null}if(S==null)p===C||o&&t.data==C||(t.data=C);else{if(f=f&&Ee.call(t.childNodes),p=s.props||de,!o&&f!=null)for(p={},a=0;a<t.attributes.length;a++)p[(h=t.attributes[a]).name]=h.value;for(a in p)if(h=p[a],a!="children"){if(a=="dangerouslySetInnerHTML")r=h;else if(!(a in C)){if(a=="value"&&"defaultValue"in C||a=="checked"&&"defaultChecked"in C)continue;ye(t,a,null,h,n)}}for(a in C)h=C[a],a=="children"?i=h:a=="dangerouslySetInnerHTML"?c=h:a=="value"?d=h:a=="checked"?A=h:o&&typeof h!="function"||p[a]===h||ye(t,a,h,p[a],n);if(c)o||r&&(c.__html==r.__html||c.__html==t.innerHTML)||(t.innerHTML=c.__html),e.__k=[];else if(r&&(t.innerHTML=""),Mt(e.type=="template"?t.content:t,Me(i)?i:[i],e,s,u,S=="foreignObject"?"http://www.w3.org/1999/xhtml":n,f,m,f?f[0]:s.__k&&fe(s,0),o,l),f!=null)for(a=f.length;a--;)Qe(f[a]);o||(a="value",S=="progress"&&d==null?t.removeAttribute("value"):d!=null&&(d!==t[a]||S=="progress"&&!d||S=="option"&&d!=p[a])&&ye(t,a,d,p[a],n),a="checked",A!=null&&A!=t[a]&&ye(t,a,A,p[a],n))}return t}function Je(t,e,s){try{if(typeof t=="function"){var u=typeof t.__u=="function";u&&t.__u(),u&&e==null||(t.__u=t(e))}else t.current=e}catch(n){L.__e(n,s)}}function Dt(t,e,s){var u,n;if(L.unmount&&L.unmount(t),(u=t.ref)&&(u.current&&u.current!=t.__e||Je(u,null,e)),(u=t.__c)!=null){if(u.componentWillUnmount)try{u.componentWillUnmount()}catch(f){L.__e(f,e)}u.base=u.__P=null}if(u=t.__k)for(n=0;n<u.length;n++)u[n]&&Dt(u[n],e,s||typeof t.type!="function");s||Qe(t.__e),t.__c=t.__=t.__e=void 0}function Zt(t,e,s){return this.constructor(t,s)}function er(t,e,s){var u,n,f,m;e==document&&(e=document.documentElement),L.__&&L.__(t,e),n=(u=!1)?null:e.__k,f=[],m=[],je(e,t=e.__k=Qt(xe,null,[t]),n||de,de,e.namespaceURI,n?null:e.firstChild?Ee.call(e.childNodes):null,f,n?n.__e:e.firstChild,u,m),It(f,t,m)}Ee=Rt.slice,L={__e:function(t,e,s,u){for(var n,f,m;e=e.__;)if((n=e.__c)&&!n.__)try{if((f=n.constructor)&&f.getDerivedStateFromError!=null&&(n.setState(f.getDerivedStateFromError(t)),m=n.__d),n.componentDidCatch!=null&&(n.componentDidCatch(t,u||{}),m=n.__d),m)return n.__E=n}catch(o){t=o}throw t}},Tt=0,Ae.prototype.setState=function(t,e){var s;s=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=ee({},this.state),typeof t=="function"&&(t=t(ee({},s),this.props)),t&&ee(s,t),t!=null&&this.__v&&(e&&this._sb.push(e),rt(this))},Ae.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),rt(this))},Ae.prototype.render=xe,oe=[],bt=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,wt=function(t,e){return t.__v.__b-e.__v.__b},we.__r=0,kt=/(PointerCapture)$|Capture$/i,Ve=0,Pe=at(!1),Fe=at(!0);var tr=0;function x(t,e,s,u,n,f){e||(e={});var m,o,l=e;if("ref"in l)for(o in l={},e)o=="ref"?m=e[o]:l[o]=e[o];var a={type:t,props:l,key:s,ref:m,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--tr,__i:-1,__u:0,__source:n,__self:f};if(typeof t=="function"&&(m=t.defaultProps))for(o in m)l[o]===void 0&&(l[o]=m[o]);return L.vnode&&L.vnode(a),a}var ge,P,Le,st,Ne=0,Wt=[],F=L,ot=F.__b,it=F.__r,lt=F.diffed,ut=F.__c,ct=F.unmount,mt=F.__;function Xe(t,e){F.__h&&F.__h(P,t,Ne||e),Ne=0;var s=P.__H||(P.__H={__:[],__h:[]});return t>=s.__.length&&s.__.push({}),s.__[t]}function Lt(t){return Ne=1,rr(Pt,t)}function rr(t,e,s){var u=Xe(ge++,2);if(u.t=t,!u.__c&&(u.__=[Pt(void 0,e),function(o){var l=u.__N?u.__N[0]:u.__[0],a=u.t(l,o);l!==a&&(u.__N=[a,u.__[1]],u.__c.setState({}))}],u.__c=P,!P.__f)){var n=function(o,l,a){if(!u.__c.__H)return!0;var c=u.__c.__H.__.filter(function(i){return!!i.__c});if(c.every(function(i){return!i.__N}))return!f||f.call(this,o,l,a);var r=u.__c.props!==o;return c.forEach(function(i){if(i.__N){var h=i.__[0];i.__=i.__N,i.__N=void 0,h!==i.__[0]&&(r=!0)}}),f&&f.call(this,o,l,a)||r};P.__f=!0;var f=P.shouldComponentUpdate,m=P.componentWillUpdate;P.componentWillUpdate=function(o,l,a){if(this.__e){var c=f;f=void 0,n(o,l,a),f=c}m&&m.call(this,o,l,a)},P.shouldComponentUpdate=n}return u.__N||u.__}function Bt(t,e){var s=Xe(ge++,3);!F.__s&&Ht(s.__H,e)&&(s.__=t,s.u=e,P.__H.__h.push(s))}function me(t,e){var s=Xe(ge++,7);return Ht(s.__H,e)&&(s.__=t(),s.__H=e,s.__h=t),s.__}function nr(){for(var t;t=Wt.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(_e),t.__H.__h.forEach($e),t.__H.__h=[]}catch(e){t.__H.__h=[],F.__e(e,t.__v)}}F.__b=function(t){P=null,ot&&ot(t)},F.__=function(t,e){t&&e.__k&&e.__k.__m&&(t.__m=e.__k.__m),mt&&mt(t,e)},F.__r=function(t){it&&it(t),ge=0;var e=(P=t.__c).__H;e&&(Le===P?(e.__h=[],P.__h=[],e.__.forEach(function(s){s.__N&&(s.__=s.__N),s.u=s.__N=void 0})):(e.__h.forEach(_e),e.__h.forEach($e),e.__h=[],ge=0)),Le=P},F.diffed=function(t){lt&&lt(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(Wt.push(e)!==1&&st===F.requestAnimationFrame||((st=F.requestAnimationFrame)||ar)(nr)),e.__H.__.forEach(function(s){s.u&&(s.__H=s.u),s.u=void 0})),Le=P=null},F.__c=function(t,e){e.some(function(s){try{s.__h.forEach(_e),s.__h=s.__h.filter(function(u){return!u.__||$e(u)})}catch(u){e.some(function(n){n.__h&&(n.__h=[])}),e=[],F.__e(u,s.__v)}}),ut&&ut(t,e)},F.unmount=function(t){ct&&ct(t);var e,s=t.__c;s&&s.__H&&(s.__H.__.forEach(function(u){try{_e(u)}catch(n){e=n}}),s.__H=void 0,e&&F.__e(e,s.__v))};var ht=typeof requestAnimationFrame=="function";function ar(t){var e,s=function(){clearTimeout(u),ht&&cancelAnimationFrame(e),setTimeout(t)},u=setTimeout(s,35);ht&&(e=requestAnimationFrame(s))}function _e(t){var e=P,s=t.__c;typeof s=="function"&&(t.__c=void 0,s()),P=e}function $e(t){var e=P;t.__c=t.__(),P=e}function Ht(t,e){return!t||t.length!==e.length||e.some(function(s,u){return s!==t[u]})}function Pt(t,e){return typeof e=="function"?e(t):e}var sr=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function or(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Ie={};(function(t){(function(e,s){if(typeof t.nodeName!="string")s(t);else{var u={};s(u),e.AnsiUp=u.default}})(sr,function(e){var s=this&&this.__makeTemplateObject||function(o,l){return Object.defineProperty?Object.defineProperty(o,"raw",{value:l}):o.raw=l,o},u;(function(o){o[o.EOS=0]="EOS",o[o.Text=1]="Text",o[o.Incomplete=2]="Incomplete",o[o.ESC=3]="ESC",o[o.Unknown=4]="Unknown",o[o.SGR=5]="SGR",o[o.OSCURL=6]="OSCURL"})(u||(u={}));var n=function(){function o(){this.VERSION="5.2.1",this.setup_palettes(),this._use_classes=!1,this.bold=!1,this.italic=!1,this.underline=!1,this.fg=this.bg=null,this._buffer="",this._url_whitelist={http:1,https:1},this._escape_html=!0}return Object.defineProperty(o.prototype,"use_classes",{get:function(){return this._use_classes},set:function(l){this._use_classes=l},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"url_whitelist",{get:function(){return this._url_whitelist},set:function(l){this._url_whitelist=l},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"escape_html",{get:function(){return this._escape_html},set:function(l){this._escape_html=l},enumerable:!1,configurable:!0}),o.prototype.setup_palettes=function(){var l=this;this.ansi_colors=[[{rgb:[0,0,0],class_name:"ansi-black"},{rgb:[187,0,0],class_name:"ansi-red"},{rgb:[0,187,0],class_name:"ansi-green"},{rgb:[187,187,0],class_name:"ansi-yellow"},{rgb:[0,0,187],class_name:"ansi-blue"},{rgb:[187,0,187],class_name:"ansi-magenta"},{rgb:[0,187,187],class_name:"ansi-cyan"},{rgb:[255,255,255],class_name:"ansi-white"}],[{rgb:[85,85,85],class_name:"ansi-bright-black"},{rgb:[255,85,85],class_name:"ansi-bright-red"},{rgb:[0,255,0],class_name:"ansi-bright-green"},{rgb:[255,255,85],class_name:"ansi-bright-yellow"},{rgb:[85,85,255],class_name:"ansi-bright-blue"},{rgb:[255,85,255],class_name:"ansi-bright-magenta"},{rgb:[85,255,255],class_name:"ansi-bright-cyan"},{rgb:[255,255,255],class_name:"ansi-bright-white"}]],this.palette_256=[],this.ansi_colors.forEach(function(C){C.forEach(function(S){l.palette_256.push(S)})});for(var a=[0,95,135,175,215,255],c=0;c<6;++c)for(var r=0;r<6;++r)for(var i=0;i<6;++i){var h={rgb:[a[c],a[r],a[i]],class_name:"truecolor"};this.palette_256.push(h)}for(var d=8,A=0;A<24;++A,d+=10){var p={rgb:[d,d,d],class_name:"truecolor"};this.palette_256.push(p)}},o.prototype.escape_txt_for_html=function(l){return this._escape_html?l.replace(/[&<>"']/gm,function(a){if(a==="&")return"&amp;";if(a==="<")return"&lt;";if(a===">")return"&gt;";if(a==='"')return"&quot;";if(a==="'")return"&#x27;"}):l},o.prototype.append_buffer=function(l){var a=this._buffer+l;this._buffer=a},o.prototype.get_next_packet=function(){var l={kind:u.EOS,text:"",url:""},a=this._buffer.length;if(a==0)return l;var c=this._buffer.indexOf("\x1B");if(c==-1)return l.kind=u.Text,l.text=this._buffer,this._buffer="",l;if(c>0)return l.kind=u.Text,l.text=this._buffer.slice(0,c),this._buffer=this._buffer.slice(c),l;if(c==0){if(a<3)return l.kind=u.Incomplete,l;var r=this._buffer.charAt(1);if(r!="["&&r!="]"&&r!="(")return l.kind=u.ESC,l.text=this._buffer.slice(0,1),this._buffer=this._buffer.slice(1),l;if(r=="["){this._csi_regex||(this._csi_regex=f(s([`
                        ^                           # beginning of line
                                                    #
                                                    # First attempt
                        (?:                         # legal sequence
                          \x1B[                      # CSI
                          ([<-?]?)              # private-mode char
                          ([d;]*)                    # any digits or semicolons
                          ([ -/]?               # an intermediate modifier
                          [@-~])                # the command
                        )
                        |                           # alternate (second attempt)
                        (?:                         # illegal sequence
                          \x1B[                      # CSI
                          [ -~]*                # anything legal
                          ([\0-:])              # anything illegal
                        )
                    `],[`
                        ^                           # beginning of line
                                                    #
                                                    # First attempt
                        (?:                         # legal sequence
                          \\x1b\\[                      # CSI
                          ([\\x3c-\\x3f]?)              # private-mode char
                          ([\\d;]*)                    # any digits or semicolons
                          ([\\x20-\\x2f]?               # an intermediate modifier
                          [\\x40-\\x7e])                # the command
                        )
                        |                           # alternate (second attempt)
                        (?:                         # illegal sequence
                          \\x1b\\[                      # CSI
                          [\\x20-\\x7e]*                # anything legal
                          ([\\x00-\\x1f:])              # anything illegal
                        )
                    `])));var i=this._buffer.match(this._csi_regex);if(i===null)return l.kind=u.Incomplete,l;if(i[4])return l.kind=u.ESC,l.text=this._buffer.slice(0,1),this._buffer=this._buffer.slice(1),l;i[1]!=""||i[3]!="m"?l.kind=u.Unknown:l.kind=u.SGR,l.text=i[2];var h=i[0].length;return this._buffer=this._buffer.slice(h),l}else if(r=="]"){if(a<4)return l.kind=u.Incomplete,l;if(this._buffer.charAt(2)!="8"||this._buffer.charAt(3)!=";")return l.kind=u.ESC,l.text=this._buffer.slice(0,1),this._buffer=this._buffer.slice(1),l;this._osc_st||(this._osc_st=m(s([`
                        (?:                         # legal sequence
                          (\x1B\\)                    # ESC                           |                           # alternate
                          (\x07)                      # BEL (what xterm did)
                        )
                        |                           # alternate (second attempt)
                        (                           # illegal sequence
                          [\0-]                 # anything illegal
                          |                           # alternate
                          [\b-]                 # anything illegal
                          |                           # alternate
                          [-]                 # anything illegal
                        )
                    `],[`
                        (?:                         # legal sequence
                          (\\x1b\\\\)                    # ESC \\
                          |                           # alternate
                          (\\x07)                      # BEL (what xterm did)
                        )
                        |                           # alternate (second attempt)
                        (                           # illegal sequence
                          [\\x00-\\x06]                 # anything illegal
                          |                           # alternate
                          [\\x08-\\x1a]                 # anything illegal
                          |                           # alternate
                          [\\x1c-\\x1f]                 # anything illegal
                        )
                    `]))),this._osc_st.lastIndex=0;{var d=this._osc_st.exec(this._buffer);if(d===null)return l.kind=u.Incomplete,l;if(d[3])return l.kind=u.ESC,l.text=this._buffer.slice(0,1),this._buffer=this._buffer.slice(1),l}{var A=this._osc_st.exec(this._buffer);if(A===null)return l.kind=u.Incomplete,l;if(A[3])return l.kind=u.ESC,l.text=this._buffer.slice(0,1),this._buffer=this._buffer.slice(1),l}this._osc_regex||(this._osc_regex=f(s([`
                        ^                           # beginning of line
                                                    #
                        \x1B]8;                    # OSC Hyperlink
                        [ -:<-~]*       # params (excluding ;)
                        ;                           # end of params
                        ([!-~]{0,512})        # URL capture
                        (?:                         # ST
                          (?:\x1B\\)                  # ESC                           |                           # alternate
                          (?:\x07)                    # BEL (what xterm did)
                        )
                        ([ -~]+)              # TEXT capture
                        \x1B]8;;                   # OSC Hyperlink End
                        (?:                         # ST
                          (?:\x1B\\)                  # ESC                           |                           # alternate
                          (?:\x07)                    # BEL (what xterm did)
                        )
                    `],[`
                        ^                           # beginning of line
                                                    #
                        \\x1b\\]8;                    # OSC Hyperlink
                        [\\x20-\\x3a\\x3c-\\x7e]*       # params (excluding ;)
                        ;                           # end of params
                        ([\\x21-\\x7e]{0,512})        # URL capture
                        (?:                         # ST
                          (?:\\x1b\\\\)                  # ESC \\
                          |                           # alternate
                          (?:\\x07)                    # BEL (what xterm did)
                        )
                        ([\\x20-\\x7e]+)              # TEXT capture
                        \\x1b\\]8;;                   # OSC Hyperlink End
                        (?:                         # ST
                          (?:\\x1b\\\\)                  # ESC \\
                          |                           # alternate
                          (?:\\x07)                    # BEL (what xterm did)
                        )
                    `])));var i=this._buffer.match(this._osc_regex);if(i===null)return l.kind=u.ESC,l.text=this._buffer.slice(0,1),this._buffer=this._buffer.slice(1),l;l.kind=u.OSCURL,l.url=i[1],l.text=i[2];var h=i[0].length;return this._buffer=this._buffer.slice(h),l}else if(r=="(")return l.kind=u.Unknown,this._buffer=this._buffer.slice(3),l}},o.prototype.ansi_to_html=function(l){this.append_buffer(l);for(var a=[];;){var c=this.get_next_packet();if(c.kind==u.EOS||c.kind==u.Incomplete)break;c.kind==u.ESC||c.kind==u.Unknown||(c.kind==u.Text?a.push(this.transform_to_html(this.with_state(c))):c.kind==u.SGR?this.process_ansi(c):c.kind==u.OSCURL&&a.push(this.process_hyperlink(c)))}return a.join("")},o.prototype.with_state=function(l){return{bold:this.bold,italic:this.italic,underline:this.underline,fg:this.fg,bg:this.bg,text:l.text}},o.prototype.process_ansi=function(l){for(var a=l.text.split(";");a.length>0;){var c=a.shift(),r=parseInt(c,10);if(isNaN(r)||r===0)this.fg=this.bg=null,this.bold=!1,this.italic=!1,this.underline=!1;else if(r===1)this.bold=!0;else if(r===3)this.italic=!0;else if(r===4)this.underline=!0;else if(r===22)this.bold=!1;else if(r===23)this.italic=!1;else if(r===24)this.underline=!1;else if(r===39)this.fg=null;else if(r===49)this.bg=null;else if(r>=30&&r<38)this.fg=this.ansi_colors[0][r-30];else if(r>=40&&r<48)this.bg=this.ansi_colors[0][r-40];else if(r>=90&&r<98)this.fg=this.ansi_colors[1][r-90];else if(r>=100&&r<108)this.bg=this.ansi_colors[1][r-100];else if((r===38||r===48)&&a.length>0){var i=r===38,h=a.shift();if(h==="5"&&a.length>0){var d=parseInt(a.shift(),10);d>=0&&d<=255&&(i?this.fg=this.palette_256[d]:this.bg=this.palette_256[d])}if(h==="2"&&a.length>2){var A=parseInt(a.shift(),10),p=parseInt(a.shift(),10),C=parseInt(a.shift(),10);if(A>=0&&A<=255&&p>=0&&p<=255&&C>=0&&C<=255){var S={rgb:[A,p,C],class_name:"truecolor"};i?this.fg=S:this.bg=S}}}}},o.prototype.transform_to_html=function(l){var a=l.text;if(a.length===0||(a=this.escape_txt_for_html(a),!l.bold&&!l.italic&&!l.underline&&l.fg===null&&l.bg===null))return a;var c=[],r=[],i=l.fg,h=l.bg;l.bold&&c.push("font-weight:bold"),l.italic&&c.push("font-style:italic"),l.underline&&c.push("text-decoration:underline"),this._use_classes?(i&&(i.class_name!=="truecolor"?r.push(i.class_name+"-fg"):c.push("color:rgb("+i.rgb.join(",")+")")),h&&(h.class_name!=="truecolor"?r.push(h.class_name+"-bg"):c.push("background-color:rgb("+h.rgb.join(",")+")"))):(i&&c.push("color:rgb("+i.rgb.join(",")+")"),h&&c.push("background-color:rgb("+h.rgb+")"));var d="",A="";return r.length&&(d=' class="'+r.join(" ")+'"'),c.length&&(A=' style="'+c.join(";")+'"'),"<span"+A+d+">"+a+"</span>"},o.prototype.process_hyperlink=function(l){var a=l.url.split(":");if(a.length<1||!this._url_whitelist[a[0]])return"";var c='<a href="'+this.escape_txt_for_html(l.url)+'">'+this.escape_txt_for_html(l.text)+"</a>";return c},o}();function f(o){var l=o.raw[0],a=/^\s+|\s+\n|\s*#[\s\S]*?\n|\n/gm,c=l.replace(a,"");return new RegExp(c)}function m(o){var l=o.raw[0],a=/^\s+|\s+\n|\s*#[\s\S]*?\n|\n/gm,c=l.replace(a,"");return new RegExp(c,"g")}Object.defineProperty(e,"__esModule",{value:!0}),e.default=n})})(Ie);const Te=or(Ie),ft=zt({__proto__:null,default:Te},[Ie]);function X(t){const e=t.match(/^\s*/);return e?e[0].length:0}function R(t){return t?t.toLowerCase().replace(/\s+/g," ").trim():""}function ne(t){const e=/^(?:(\d+)x?\s+)?(.*)/,s=t.trim().match(e);if(s){const u=s[1]?`${s[1]}x`:"1x";let n=s[2].trim();return n=n.replace(/^with\s+/i,"").trim(),{quantity:u,name:n}}return{quantity:"1x",name:t.trim()}}function K(t){return Array.isArray(t)&&t.sort((e,s)=>{const u=parseInt(String(e&&e.quantity||"1x").replace(/x/i,""),10)||1,n=parseInt(String(s&&s.quantity||"1x").replace(/x/i,""),10)||1;if(u!==n)return n-u;const f=e&&e.name?e.name.toString().toLowerCase():"",m=s&&s.name?s.name.toString().toLowerCase():"";return f<m?-1:f>m?1:0}),t}const J={"World Eaters":"Chaos","Chaos Space Marines":"Chaos","Emperor's Children":"Chaos","Death Guard":"Chaos","Chaos Daemons":"Chaos","Chaos Knights":"Chaos","Thousand Sons":"Chaos","Space Marines":"Imperium","Iron Hands":"Space Marines",Salamanders:"Space Marines","Space Wolves":"Space Marines",Ultramarines:"Space Marines","White Scars":"Space Marines","Adepta Sororitas":"Imperium","Astra Militarum":"Imperium","Imperial Fists":"Space Marines","Dark Angels":"Space Marines","Blood Angels":"Space Marines","Raven Guard":"Space Marines","Black Templars":"Space Marines",Deathwatch:"Space Marines","Grey Knights":"Imperium","Imperial Knights":"Imperium","Adeptus Custodes":"Imperium","Adeptus Titanicus":"Imperium","Adeptus Mechanicus":"Imperium","Agents of the Imperium":"Imperium",Aeldari:"Xenos",Drukhari:"Xenos",Ynnari:"Xenos",Harlequins:"Xenos",Necrons:"Xenos",Orks:"Xenos",Tyranids:"Xenos","T'au Empire":"Xenos",Tau:"Xenos","T'au":"Xenos","Genestealer Cults":"Xenos","Leagues of Votann":"Xenos"};function ie(t){if(!t)return t;t.SUMMARY=t.SUMMARY||{};const e=t.SUMMARY;e.LIST_TITLE=e.LIST_TITLE||"",e.FACTION_KEYWORD&&(e.FACTION_KEYWORD=String(e.FACTION_KEYWORD).trim()),e.DETACHMENT&&(e.DETACHMENT=String(e.DETACHMENT).replace(/\u00A0/g," ").trim()),e.TOTAL_ARMY_POINTS&&(e.TOTAL_ARMY_POINTS=String(e.TOTAL_ARMY_POINTS).trim());const s=n=>{if(!n)return"";try{return n.toString().normalize("NFD").replace(new RegExp("\\p{M}","gu"),"").replace(/[\u2018\u2019\u201B\u2032]/g,"'").replace(/[^\w\s'\-]/g,"").toLowerCase().trim()}catch(f){return n.toString().toLowerCase().trim()}},u=e.FACTION_KEYWORD||null;if(u){const n=s(u);let f;for(const m of Object.keys(J))if(s(m)===n){f=m;break}if(f){const m=u.toString().replace(/[\u2018\u2019\u201B\u2032]/g,"'").trim();e.DISPLAY_FACTION=`${J[f]} - ${m}`}else e.DISPLAY_FACTION=e.DISPLAY_FACTION||u+(e.DETACHMENT?` - ${e.DETACHMENT}`:"")}else e.DETACHMENT?e.DISPLAY_FACTION=e.DISPLAY_FACTION||e.DETACHMENT:e.DISPLAY_FACTION=e.DISPLAY_FACTION||"";if(!e.FACTION_KEY){if(e.FACTION_KEYWORD)try{e.FACTION_KEY=e.FACTION_KEYWORD.toString().toLowerCase()}catch(n){e.FACTION_KEY=String(e.FACTION_KEYWORD).toLowerCase()}else if(e.DISPLAY_FACTION){const n=(e.DISPLAY_FACTION||"").split(" - ")[0];try{e.FACTION_KEY=n.toString().toLowerCase()}catch(f){e.FACTION_KEY=String(n).toLowerCase()}}}return t}function se(t,e,s,u,n="",f=!1,m="wargear"){if(!t)return;t.items=t.items||[];const o=ne(String(e||"").trim()),l=o.quantity?String(o.quantity):"1x",a=o.name||"",c=R(a);if(f){const i=String(s||""),h=String(n||"");if(R(i)===R(a)||h&&R(h)===R(a))return}const r=t.items.find(i=>R(i.name||"")===c);if(r){const i=parseInt(String(r.quantity||"1x").replace(/x/i,""),10)||0,h=parseInt(String(l||"1x").replace(/x/i,""),10)||0;r.quantity=`${i+h}x`}else{const i=R(a)==="warlord"?"special":m;t.items.push({quantity:l,name:a,items:[],type:i,nameshort:""})}}function pt(t,e){if(!t||!e)return;e.items=e.items||[];const s=t.trim(),u=s.match(/\(([^)]+)\)$/),n=u?` (${u[1]})`:"",f=s.replace(/\s*\([^)]+\)$/,"").trim(),m=R(f);if((e.items||[]).some(r=>r&&r.type==="special"&&R((r.name||"").replace(/^Enhancement:\s*/i,""))===m))return;const a=`E: ${f.split(/\s+/).map(r=>r[0]?r[0].toUpperCase():"").join("")}${n}`.trim(),c={quantity:"1x",name:`Enhancement: ${f}`,nameshort:a,items:[],type:"special"};e.items.push(c)}function ir(t){const e={SUMMARY:{},CHARACTER:[],"OTHER DATASHEETS":[]};if(!Array.isArray(t))return e;const s={},u=[];let n=0;for(;n<t.length;n++){const i=(t[n]||"").trim();if(i){if(i.startsWith("+")||i.startsWith("&")){u.push(i);continue}break}}for(const r of u){if(r.startsWith("&")){const A=r.replace(/^&\s*/,"").match(/^(.*?)\s*\(on\s+(?:(Char\d+):\s*)?(.*)\)$/i);if(A){const p=A[1].trim(),C=(A[3]||"").trim();C&&(s[C]=p)}continue}const h=r.replace(/^\+\s*/,"").match(/^([^:]+):\s*(.*)$/);if(h){const d=h[1].trim().toUpperCase(),A=h[2].trim();if(d==="FACTION KEYWORD"){const p=A.split(" - ");e.SUMMARY.FACTION_KEYWORD=p[p.length-1].trim()}else d==="DETACHMENT"?e.SUMMARY.DETACHMENT=A.replace(/\u00A0/g," "):d==="TOTAL ARMY POINTS"&&(e.SUMMARY.TOTAL_ARMY_POINTS=A)}}if(e.SUMMARY.LIST_TITLE="",e.SUMMARY&&e.SUMMARY.FACTION_KEYWORD){const r=e.SUMMARY.FACTION_KEYWORD,i=Object.keys(J).find(d=>d.toLowerCase()===(r||"").toString().toLowerCase()),h=i?J[i]:null;h?e.SUMMARY.DISPLAY_FACTION=`${h} - ${r}`:e.SUMMARY.DISPLAY_FACTION=r+(e.SUMMARY.DETACHMENT?` - ${e.SUMMARY.DETACHMENT}`:"");try{e.SUMMARY.FACTION_KEY=r.toString().toLowerCase()}catch(d){}}let f=null,m=null;const o=/^(?:(Char\d+):\s*)?(?:(\d+)x?\s+)?(.*?)\s*\((\d+)\s*(?:pts|points)\)(?::\s*(.*))?$/i,l=/^\s*(?:\u2022|\*|-|\u25e6)\s*(.*)$/;for(;n<t.length;n++){const r=t[n]||"",i=r.trim();if(!i)continue;if(/^Enhancement:\s*/i.test(i)){const C=i.replace(/^Enhancement:\s*/i,"").trim();m&&pt(C,m);continue}const h=i.match(o);if(h){const C=h[1],S=h[2]?`${h[2]}x`:"1x",b=(h[3]||"").trim(),g=parseInt(h[4],10)||0,y=h[5],_={quantity:S,name:b,points:g,items:[],isComplex:!1,nameshort:""};C?(e.CHARACTER.push(_),m=_):(e["OTHER DATASHEETS"]=e["OTHER DATASHEETS"]||[],e["OTHER DATASHEETS"].push(_)),f=_,y&&y.split(",").map(w=>w.trim()).filter(Boolean).forEach(w=>se(_,w,_.name,e.SUMMARY.FACTION_KEYWORD||"",_.name,!0));continue}const d=r.match(l);if(d){const C=d[1].trim(),S=C.match(/^(\d+)\s+with\s+(.*)$/i);if(S&&f){const y=parseInt(S[1],10)||1,_=S[2],w=f.items&&f.items.length>0?f.items[f.items.length-1]:f;_.split(",").map(T=>T.trim()).filter(Boolean).forEach(T=>se(w,`${y}x ${T}`,w.name,e.SUMMARY.FACTION_KEYWORD||"",f.name,!0));continue}const b=C.match(/^(\d+x?)\s+(.*?):\s*(.*)$/i);if(b&&f){const y=b[1],_=b[2].trim(),w=b[3]||"",T={quantity:y,name:_,items:[],type:"subunit"};if(f.items=f.items||[],f.items.push(T),w){const k=w.match(/^(\d+)\s+with\s+(.*)$/i);if(k){const E=parseInt(k[1],10)||1;k[2].split(",").map(M=>M.trim()).filter(Boolean).forEach(M=>se(T,`${E}x ${M}`,T.name,e.SUMMARY.FACTION_KEYWORD||"",f.name,!0))}else w.split(",").map(E=>E.trim()).filter(Boolean).forEach(E=>se(T,E,T.name,e.SUMMARY.FACTION_KEYWORD||"",f.name,!0))}continue}const g=C.match(/^(\d+x?)\s+(.*)$/i);if(g&&f){const y={quantity:g[1],name:g[2].trim(),items:[],type:"subunit"};f.items=f.items||[],f.items.push(y);continue}if(f){se(f,C,f.name,e.SUMMARY.FACTION_KEYWORD||"",f.name,!0);continue}continue}const A=i.match(/^(\d+)\s+with\s+(.*)$/i);if(A&&f){const C=parseInt(A[1],10)||1,S=A[2],b=f.items&&f.items.length>0?f.items[f.items.length-1]:f;S.split(",").map(g=>g.trim()).filter(Boolean).forEach(g=>se(b,`${C}x ${g}`,b.name,e.SUMMARY.FACTION_KEYWORD||"",f.name,!0));continue}const p=i.match(/^(.*?):\s*(.*)$/);if(p&&f){(p[2]||"").split(",").map(S=>S.trim()).filter(Boolean).forEach(S=>se(f,S,f.name,e.SUMMARY.FACTION_KEYWORD||"",f.name,!0));continue}}const a=[...e.CHARACTER||[],...e["OTHER DATASHEETS"]||[]],c=r=>String(r||"").toLowerCase().replace(/[^a-z0-9 ]/g,"").trim();for(const r of Object.keys(s)){const i=s[r],h=a.find(d=>c(d.name).includes(c(r))||c(`${d.quantity} ${d.name}`).includes(c(r)));h&&pt(i,h)}for(const r of a){r&&Array.isArray(r.items)&&r.items.length>0&&K(r.items);const i=r&&Array.isArray(r.items)?r.items.filter(h=>h&&h.type==="subunit"):[];for(const h of i)h&&Array.isArray(h.items)&&h.items.length>0&&K(h.items)}return ie(e),e}function G(t,e,s,u,n="",f=!1,m="wargear"){if(!t)return;t.items=t.items||[];const o=String(e||"").trim();if(/battlesuit support system|homing beacon|marker drone/i.test(o))try{Y.push(`processing raw=${o} for target=${t&&t.name}`)}catch(g){}let l=o.split(",").map(g=>g.trim()).filter(Boolean);try{const g=new Set;l=l.filter(y=>{const _=R(he(Z(y)));return g.has(_)?!1:(g.add(_),!0)})}catch(g){}try{/stealth shas'vre|stealth battlesuits/i.test((t&&t.name||"")+(n||"")+o)&&Y.push(`splitParts target=${t&&t.name} top=${n} parts=${JSON.stringify(l)}`)}catch(g){}if(l.length>1){l.forEach(g=>G(t,g,s,u,n,f,m));return}const a=ne(o),c=a.quantity!==void 0&&a.quantity!==null;let r=c?String(a.quantity):"1x",i=a.name||"";try{i=he(Z(i))}catch(g){}const h=/battlesuit support system|homing beacon|marker drone/i;try{const g=i.toLowerCase();if(g.includes("battlesuit support system")||g.includes("homing beacon")||g.includes("marker drone"))try{Y.push(`addItemToTarget target=${t&&t.name} raw=${o}`)}catch(y){}}catch(g){}const d=i.match(/^(\d+)x\s+(.*)$/i);if(d){const g=parseInt(d[1],10)||1,y=parseInt(String(r||"1x").replace(/x/i,""),10)||1;r=`${Math.max(1,y*g)}x`,i=d[2]}try{Y.push(`PARSE_QTY name=${i} parsedQtyRaw=${String(a.quantity||"")} qtyToken=${r}`)}catch(g){}let A=(g=>isNaN(g)?1:g)(parseInt(String(r||"1x").replace(/x/i,""),10)),p=A;try{if(t&&t.type==="subunit"){const g=parseInt(String(t.quantity||"1x").replace(/[^0-9]/g,""),10)||1;try{Y.push(`CALC_EFFECTIVE target=${t&&t.name} parentQty=${g} parsedQty=${A} hasExplicit=${c}`)}catch(y){}p=c?A:g;try{Y.push(`EFFECTIVE_QTY target=${t&&t.name} effectiveQty=${p}`)}catch(y){}}}catch(g){}const C=i,S=R(i);if(f){const g=String(s||""),y=String(n||"");if(R(g)===R(i)||y&&R(y)===R(i)){if(h.test(i))try{Y.push(`SKIP matched unitname name=${i} ctx=${g} top=${y}`)}catch(_){}return}}const b=t.items.find(g=>R(g.name||"")===S);if(b){const g=parseInt(String(b.quantity||"1x").replace(/x/i,""),10)||0,y=g+p;b.quantity=`${y}x`;try{Y.push(`UPDATED existing name=${i} existing=${g} added=${p} new=${y} target=${t&&t.name}`)}catch(_){}}else{const g=R(i)==="warlord"?"special":m;t.items.push({quantity:`${p}x`,name:C,items:[],type:g,nameshort:""});try{Y.push(`PUSHED new name=${i} quantity=${p} target=${t&&t.name}`)}catch(y){}}}function Z(t){if(!t)return t;const e=t.toLowerCase();return e.includes("shield")&&e.includes("drone")?"Shield Drone":e.includes("marker")&&e.includes("drone")?"Marker Drone":e.includes("marker")&&e.includes("beacon")?"Homing Beacon":t}function he(t){return t&&t.split(/\s+/).map(e=>!e||/[A-Z]/.test(e.slice(1))?e:e[0].toUpperCase()+e.slice(1).toLowerCase()).join(" ")}function dt(t,e){if(!e)return`${t}x`;const s=String(e).trim(),u=s.match(/^(\d+)x\s+(.*)$/i);if(u){const n=parseInt(u[1],10)||1,f=u[2]||"";return`${Math.max(1,t*n)}x ${f}`}return`${t}x ${s}`}function lr(t,e){if(!t||!e)return;e.items=e.items||[];const s=t.trim(),u=s.match(/\(([^)]+)\)$/),n=u?` (${u[1]})`:"",f=s.replace(/\s*\([^)]+\)$/,"").trim(),m=R(f);if((e.items||[]).some(r=>{if(!r||!r.name)return!1;const i=String(r.name||"").replace(/^Enhancement:\s*/i,"").replace(/\s*\([^)]+\)$/,"").trim();return R(i)===m}))return;const a=`E: ${f.split(/\s+/).map(r=>r[0]?r[0].toUpperCase():"").join("")}${n}`.trim(),c={quantity:"1x",name:`Enhancement: ${f}`,nameshort:a,items:[],type:"special"};e.items.push(c)}function ur(t){const e={SUMMARY:{},CHARACTER:[],"OTHER DATASHEETS":[]};if(!Array.isArray(t))return e;const s=[];let u=0;for(;u<t.length;u++){const c=(t[u]||"").trim();if(c){if(c.startsWith("+")){s.push(c);continue}if(!c.startsWith("&"))break}}for(const a of s){const r=a.replace(/^\+\s*/,"").match(/^([^:]+):\s*(.*)$/);if(r){const i=r[1].trim().toUpperCase(),h=r[2].trim();if(i==="FACTION KEYWORD"){const d=h.split(" - ");e.SUMMARY.FACTION_KEYWORD=d[d.length-1].trim()}else i==="DETACHMENT"?e.SUMMARY.DETACHMENT=h.replace(/\u00A0/g," "):i==="TOTAL ARMY POINTS"&&(e.SUMMARY.TOTAL_ARMY_POINTS=h)}}if(e.SUMMARY.LIST_TITLE="",e.SUMMARY&&e.SUMMARY.FACTION_KEYWORD){const a=e.SUMMARY.FACTION_KEYWORD,c=Object.keys(J).find(i=>i.toLowerCase()===(a||"").toString().toLowerCase()),r=c?J[c]:null;r?e.SUMMARY.DISPLAY_FACTION=`${r} - ${a}`:e.SUMMARY.DISPLAY_FACTION=a+(e.SUMMARY.DETACHMENT?` - ${e.SUMMARY.DETACHMENT}`:"");try{e.SUMMARY.FACTION_KEY=a.toString().toLowerCase()}catch(i){}}const n=/^(?:(Char\d+):\s*)?(?:(\d+)x?\s+)?(.*?)\s*\((\d+)\s*(?:pts|points)\)(?::\s*(.*))?$/i,f=/^\s*(?:\u2022|\*|-|\u25e6)\s*(.*)$/;let m=null,o=null;for(;u<t.length;u++){const a=t[u]||"",c=a.trim();if(!c)continue;if(/^Enhancement:\s*/i.test(c)){const A=c.replace(/^Enhancement:\s*/i,"").trim();o&&lr(A,o);continue}const r=c.match(n);if(r){const A=r[1],p=r[2]?`${r[2]}x`:"1x",C=(r[3]||"").trim(),S=parseInt(r[4],10)||0,b=r[5],g={quantity:p,name:C,points:S,items:[],isComplex:!1,nameshort:"",charId:A||null};A?(e.CHARACTER.push(g),o=g):(e["OTHER DATASHEETS"]=e["OTHER DATASHEETS"]||[],e["OTHER DATASHEETS"].push(g)),m=g,b&&b.split(",").map(y=>y.trim()).filter(Boolean).forEach(y=>G(g,y,g.name,e.SUMMARY.FACTION_KEYWORD||"",g.name,!0));continue}const i=a.match(f);if(i){const A=i[1].trim(),p=A.match(/^(\d+)\s+with\s+(.*)$/i);if(p&&m){const b=parseInt(p[1],10)||1,g=p[2],y=m.items&&m.items.length>0?m.items[m.items.length-1]:m;try{Y.push(`WITHMATCH unit=${m.name} target=${y&&y.name} n=${b} rest=${g}`)}catch(_){}g.split(",").map(_=>_.trim()).filter(Boolean).forEach(_=>{const T=he(Z(_));if(y&&y.type==="subunit"){try{Y.push(`WITH->SUB target=${y.name} item=${T} n=${b}`)}catch(k){}G(y,`${b}x ${T}`,y.name,e.SUMMARY.FACTION_KEYWORD||"",m.name,!0)}else{try{Y.push(`WITH->UNIT unit=${m.name} item=${T} n=${b}`)}catch(k){}G(y,dt(b,T),y.name,e.SUMMARY.FACTION_KEYWORD||"",m.name,!0)}});continue}const C=A.match(/^(\d+x?)\s+(.*?):\s*(.*)$/i);if(C&&m){const b=C[1],g=C[2].trim(),y=C[3]||"",_={quantity:b,name:g,items:[],type:"subunit",_parent:m};if(m.items=m.items||[],m.items.push(_),y){const w=y.match(/^(\d+)\s+with\s+(.*)$/i);w?w[2].split(",").map(k=>k.trim()).filter(Boolean).forEach(k=>{const E=Z(k);G(_,E,_.name,e.SUMMARY.FACTION_KEYWORD||"",m.name,!0)}):y.split(",").map(T=>T.trim()).filter(Boolean).forEach(T=>{const k=Z(T);G(_,k,_.name,e.SUMMARY.FACTION_KEYWORD||"",m.name,!0)})}continue}const S=A.match(/^(\d+x?)\s+(.*)$/i);if(S&&m)if(m.charId){const b=S[1],g=S[2].trim();G(m,`${b} ${g}`,m.name,e.SUMMARY.FACTION_KEYWORD||"",m.name,!0);continue}else{const b={quantity:S[1],name:S[2].trim(),items:[],type:"subunit",_parent:m};m.items=m.items||[],m.items.push(b);continue}if(m){let b=A.split(",").map(y=>y.trim()).filter(Boolean);try{const y=m.items&&m.items.length>0?m.items[m.items.length-1]:null;y&&y.name&&(b=b.map(_=>{const w=_.match(/^(.*)\s*\(([^)]+)\)\s*$/);if(w){const T=w[1].trim();if(R(T)===R(y.name))return T}return _}))}catch(y){}try{const y=new Set;b=b.filter(_=>{const w=R(he(Z(_)));return y.has(w)?!1:(y.add(w),!0)})}catch(y){}let g=m;if(m.items&&m.items.length>0){const y=m.items[m.items.length-1];y&&y.type==="subunit"&&(g=y)}b.forEach(y=>{const _=he(Z(y));G(g,_,g.name||m.name,e.SUMMARY.FACTION_KEYWORD||"",m.name,!0)});continue}continue}const h=c.match(/^(\d+)\s+with\s+(.*)$/i);if(h&&m){const A=parseInt(h[1],10)||1,p=h[2],C=m.items&&m.items.length>0?m.items[m.items.length-1]:m;p.split(",").map(S=>S.trim()).filter(Boolean).forEach(S=>{const g=he(Z(S));C&&C.type==="subunit"?G(C,`${A}x ${g}`,C.name,e.SUMMARY.FACTION_KEYWORD||"",m.name,!0):G(C,dt(A,g),C.name,e.SUMMARY.FACTION_KEYWORD||"",m.name,!0)});continue}const d=c.match(/^(.*?):\s*(.*)$/);if(d&&m){(d[2]||"").split(",").map(p=>p.trim()).filter(Boolean).forEach(p=>{const C=Z(p);G(m,C,m.name,e.SUMMARY.FACTION_KEYWORD||"",m.name,!0)});continue}}const l=[...e.CHARACTER||[],...e["OTHER DATASHEETS"]||[]];for(const a of l){a&&Array.isArray(a.items)&&a.items.length>0&&K(a.items);const c=a&&Array.isArray(a.items)?a.items.filter(r=>r&&r.type==="subunit"):[];for(const r of c)r&&Array.isArray(r.items)&&r.items.length>0&&K(r.items)}ie(e);try{e.SUMMARY._parseDebug=(Y||[]).slice(0,200)}catch(a){}return e}const Y=[];function Ce(t){if(!t)return"";const e=new Set(["of","and","the","in","to","with","for","on","a","an","by","from"]);return String(t).split(/\s+/).map((s,u)=>{if(!s)return"";const n=s.toLowerCase();return u>0&&e.has(n)?n:n[0].toUpperCase()+n.slice(1)}).join(" ")}function pe(t,e,s,u,n="",f=!1,m="wargear",o=1){if(!t)return;t.items=t.items||[];const l=ne(String(e||"").trim()),a=l.quantity?String(l.quantity):"1x",c=l.name||"",r=R(c);if(f){const h=String(s||""),d=String(n||"");if(R(h)===R(c)||d&&R(d)===R(c))return}const i=t.items.find(h=>R(h.name||"")===r);if(i){const h=parseInt(String(i.quantity||"1x").replace(/x/i,""),10)||0,d=parseInt(String(a||"1x").replace(/x/i,""),10)||0;i.quantity=`${h+d}x`}else{const h=R(c)==="warlord"?"special":m;t.items.push({quantity:a,name:c,items:[],type:h,nameshort:""})}}function gt(t,e,s){if(!t||!e)return;e.items=e.items||[];const u=t.trim(),n=u.match(/\(([^)]+)\)$/),f=n?` (${n[1]})`:"",m=u.replace(/\s*\([^)]+\)$/,"").trim(),o=R(m);if((e.items||[]).some(i=>i&&i.type==="special"&&R((i.name||"").replace(/^Enhancement:\s*/i,""))===o))return;const c=`E: ${m.split(/\s+/).map(i=>i[0]?i[0].toUpperCase():"").join("")}${f}`.trim(),r={quantity:"1x",name:`Enhancement: ${m}`,nameshort:c,items:[],type:"special"};e.items.push(r)}function cr(t){const e={SUMMARY:{},CHARACTER:[],"OTHER DATASHEETS":[]},s=/^(CHARACTERS|CHARACTER|BATTLELINE|OTHER DATASHEETS|ALLIED UNITS|DEDICATED TRANSPORTS)$/i,u=t.findIndex(i=>s.test((i||"").trim().toUpperCase()));let f=(u===-1?t.slice(0,0):t.slice(0,u)).map(i=>(i||"").trim()).filter(i=>i&&!i.startsWith("Exported with"));const m=f.findIndex(i=>i&&i.trim()!=="");if(m!==-1){const i=f[m],h=i.match(/^(.*?)\s*\((\s*\d+\s*(?:pts|points)\s*)\)\s*$/i);if(h){e.SUMMARY.LIST_TITLE=h[1].trim();const _=(h[2].match(/(\d+)/)||[])[1]||"";_&&(e.SUMMARY.TOTAL_ARMY_POINTS=`${_}pts`)}else e.SUMMARY.LIST_TITLE=i;const d=[];for(let _=m+1;_<f.length;_++){const w=f[_];w&&d.push(w)}const A=["Combat Patrol","Incursion","Strike Force","Onslaught"],p=_=>{if(!_||!/\(/.test(_))return!1;for(const w of A)if(new RegExp(w,"i").test(_))return!0;return!1},C=new Set(Object.values(J).map(_=>(_||"").toString().toLowerCase())),S=d.filter(_=>!(!_||p(_)||C.has(_.toLowerCase())));let b=null,g=null;const y=Object.keys(J).map(_=>_.toLowerCase());for(const _ of S)y.includes((_||"").toString().toLowerCase())?b=_:g||(g=_);if(!b&&S.length>0&&(b=S[0],g=S.length>1?S[1]:g),b&&(e.SUMMARY.FACTION_KEYWORD=b),g&&(e.SUMMARY.DETACHMENT=g),b){const _=Object.keys(J).find(T=>T.toLowerCase()===b.toLowerCase()),w=_?J[_]:null;w?e.SUMMARY.DISPLAY_FACTION=`${w} - ${b}`:e.SUMMARY.DISPLAY_FACTION=b+(g?` - ${g}`:"");try{e.SUMMARY.FACTION_KEY=b.toString().toLowerCase()}catch(T){}}}const o=u===-1?0:u,l=/^(.*?)\s*\(([\d,\.\s]+)\s*(?:pts|points)\)\s*$/i,a=/^\s*(?:•|\-|\+|◦)\s*(.*)$/;let c=null;for(let i=o;i<t.length;i++){const d=(t[i]||"").trim();if(!d||d.startsWith("Exported with"))continue;if(s.test(d.toUpperCase())){c=/^CHARACTERS?/i.test(d)?"CHARACTER":"OTHER DATASHEETS";continue}const A=d.match(l);if(A){const p=A[1].trim(),C=parseInt(String(A[2]).replace(/[\,\.\s]/g,""),10)||0;let S="1x",b=p;const g=p.match(/^([0-9]+x?)\s+(.*)$/i);g&&(S=g[1].toLowerCase(),b=g[2].trim());const y={quantity:S,name:b,points:C,items:[],isComplex:!1,nameshort:""},_=c==="CHARACTER"?"CHARACTER":"OTHER DATASHEETS";e[_]=e[_]||[],e[_].push(y);const w=[];let T=i+1;for(;T<t.length;){const M=t[T]||"";if(!M.trim()||s.test(M.trim().toUpperCase())||l.test(M.trim())||!/^\s+/.test(M))break;w.push(M),T++}const k=(()=>{for(let M=0;M<w.length;M++){const D=w[M];if(!D.match(a))continue;const v=X(D);for(let W=M+1;W<w.length;W++){const H=w[W];if(!H.trim()||X(H)<=v)break;if(a.test(H))return!0}}return!1})();let E=null,I=0;for(let M=0;M<w.length;M++){const D=w[M],B=D.trim(),v=D.match(a),W=X(D);if(v){const H=v[1].trim(),le=H.match(/^(.*?)\s*\(\+?\s*\d+\s*(?:pts?|points)\)\s*$/i);if(/^Enhancement:/i.test(H)){gt(H.replace(/^Enhancement:\s*/i,"").trim(),y,e.SUMMARY.FACTION_KEYWORD||"");continue}else if(le){gt(H.trim(),y,e.SUMMARY.FACTION_KEYWORD||"");continue}if(k){if(E&&typeof I=="number"&&W>I){pe(E,H,E.name,e.SUMMARY.FACTION_KEYWORD||"",y.name,!1);continue}E=null;const $=H.match(/^(\d+x?)\s+(.*)$/i),q=$?$[1]:"1x",z=$?$[2].trim():H,O={quantity:q,name:z,items:[],type:"subunit"};y.items=y.items||[],y.items.push(O),E=O,I=W;continue}pe(y,H,y.name,e.SUMMARY.FACTION_KEYWORD||"","wargear",1);continue}if(E&&W>I){pe(E,B,E.name,e.SUMMARY.FACTION_KEYWORD||"","wargear",1);continue}pe(y,B,y.name,e.SUMMARY.FACTION_KEYWORD||"","wargear",1)}i=T-1;continue}}function r(i,h){if(!(!i||typeof i!="object")){if(typeof i.name!="string"&&(i.name=""),typeof i.quantity!="string"&&(i.quantity=i.quantity?String(i.quantity):"1x"),typeof i.type!="string"&&(i.type=i.type||"wargear"),typeof i.nameshort!="string"&&(i.nameshort=i.nameshort||""),Array.isArray(i.items)||(i.items=[]),/^Enhancement:/i.test(i.name)){const d=i.name.replace(/^Enhancement:\s*/i,"").trim();i.type="special",i.nameshort=i.nameshort||(()=>{const A=d.match(/\(([^)]+)\)$/),p=A?` (${A[1]})`:"";return`E: ${d.replace(/\s*\([^)]+\)$/,"").trim().split(/\s+/).map(b=>b[0]?b[0].toUpperCase():"").join("")}${p}`.trim()})(),i.name=`Enhancement: ${Ce(d.replace(/\s*\([^)]+\)$/,"").trim())}`}else i.name=h?i.name:Ce(i.name);R(i.name)==="warlord"&&(i.type="special"),i.items=(i.items||[]).map(d=>{if(!d)return null;if(typeof d=="string"){const A={quantity:"1x",name:d.trim(),items:[],type:/^Enhancement:/i.test(d)?"special":"wargear",nameshort:""};return r(A,i.name),A.name&&(A.name=Ce(A.name)),A}return r(d,i.name),d&&d.name&&(d.name=Ce(d.name)),d}).filter(Boolean)}}for(const i of["CHARACTER","OTHER DATASHEETS"])if(Array.isArray(e[i]))for(const h of e[i]){r(h);const d=(h.items||[]).filter(A=>A&&A.type==="subunit");if(d.length>0)if(d.every(p=>R(p.name||"")===R(h.name||""))){const p=new Map;let C=0;for(const S of d){const b=parseInt(String(S.quantity||"1x").replace(/x/i,""),10)||1;C+=b;for(const g of S.items||[]){const y={items:[]};pe(y,`${g.quantity||"1x"} ${g.name}`,h.name,e.SUMMARY.FACTION_KEYWORD||"",g.type||"wargear",1);for(const _ of y.items){const w=R(_.name||"");if(p.has(w)){const T=p.get(w),k=parseInt(String(T.quantity||"1x").replace(/x/i,""),10)||0,E=parseInt(String(_.quantity||"1x").replace(/x/i,""),10)||0;T.quantity=`${k+E}x`}else p.set(w,_)}}}h.items=Array.from(p.values()),C>0&&(h.quantity=`${C}x`),h.isComplex=!1}else{const p=d.reduce((C,S)=>C+(parseInt(String(S.quantity||"1x").replace(/x/i,""),10)||0),0);p>0&&(h.quantity=`${p}x`),h.isComplex=!0}else h.isComplex=!1;Array.isArray(h.items)&&h.items.length>0&&K(h.items)}return ie(e),e}function yt(t){if(!t)return"";const e=new Set(["of","and","the","in","to","with","for","on","a","an","by","from"]);return String(t).split(/\s+/).map((s,u)=>{if(!s)return"";const n=s.toLowerCase();return u>0&&e.has(n)?n:n[0].toUpperCase()+n.slice(1)}).join(" ")}function re(t,e,s,u,n="",f=!1,m="wargear",o=1){if(!t)return;t.items=t.items||[];const l=ne(String(e||"").trim()),a=l.quantity?String(l.quantity):"1x",c=parseInt(String(a||"1x").replace(/[^0-9]/g,""),10)||1,r=`${c*(o||1)}x`;let i=l.name||"";if(!f)try{const A=i.match(/^(.+?)\s*\(([^)]+)\)\s*$/);if(A){const p=A[1].trim(),C=A[2].trim(),S=R(p),b=R(s||""),g=R(n||"");S&&(S===b||S===g||b.startsWith(S+" ")||g.startsWith(S+" ")||S.startsWith(b+" ")||S.startsWith(g+" "))&&(i=C)}}catch(A){}const h=R(i);if(f){const A=String(s||""),p=String(n||""),C=R(i),S=R(A),b=R(p),g=S&&C.startsWith(S+" "),y=b&&C.startsWith(b+" ");if(S&&(C===S||g)||b&&(C===b||y)){const _=i.match(/^(.+?)\s*\(([^)]+)\)\s*$/);if(_){const w=_[1].trim(),T=_[2].trim(),k=R(w);if(k===S||k===b||k.startsWith(S+" ")||k.startsWith(b+" ")){if(t&&t._deferredParenthetical&&R(t._deferredParenthetical)===R(T)||t&&t._deferredParenthetical&&R(t._deferredParenthetical)===R(T)||(t.items||[]).some(I=>R(I.name||"")===R(T)))return;re(t,T,s,u,n,!1,m,c);return}}return}}const d=t.items.find(A=>R(A.name||"")===h);if(d){const A=parseInt(String(d.quantity||"1x").replace(/x/i,""),10)||0,p=parseInt(String(r||"1x").replace(/x/i,""),10)||0;d.quantity=`${A+p}x`}else{const A=R(i)==="warlord"?"special":m;t.items.push({quantity:r,name:i,items:[],type:A,nameshort:""})}}function Ye(t,e,s){if(!t||!e)return;e.items=e.items||[];const u=t.trim(),n=u.match(/\(([^)]+)\)$/),f=n?` (${n[1]})`:"",m=u.replace(/\s*\([^)]+\)$/,"").trim(),o=R(m);if((e.items||[]).some(i=>i&&i.type==="special"&&R((i.name||"").replace(/^Enhancement:\s*/i,""))===o))return;const c=`E: ${m.split(/\s+/).map(i=>i[0]?i[0].toUpperCase():"").join("")}${f}`.trim(),r={quantity:"1x",name:`Enhancement: ${m}`,nameshort:c,items:[],type:"special"};e.items.push(r)}function Ct(t){const e={SUMMARY:{},CHARACTER:[],"OTHER DATASHEETS":[]},s=/^(CHARACTERS|CHARACTER|BATTLELINE|OTHER DATASHEETS|ALLIED UNITS|DEDICATED TRANSPORTS)$/i,u=/^(.*?)\s*\(([\d,\.\s]+)\s*(?:pts|points)\)\s*(?::\s*(.*))?$/i,n=/^\s*(?:•|\-|\+|◦)\s*(.*)$/;let f=null;for(let o=0;o<t.length;o++){const a=(t[o]||"").trim();if(!a)continue;if(s.test(a.toUpperCase())){f=/^CHARACTERS?/i.test(a)?"CHARACTER":"OTHER DATASHEETS";continue}const c=a.match(u);if(c){const r=c[1].trim(),i=parseInt(String(c[2]).replace(/[\,\.\s]/g,""),10)||0;let h="1x",d=r;const A=r.match(/^([0-9]+x?)\s+(.*)$/i);A&&(h=A[1].toLowerCase(),d=A[2].trim());const p={quantity:h,name:d,points:i,items:[],isComplex:!1,nameshort:""},C=f==="CHARACTER"?"CHARACTER":"OTHER DATASHEETS";e[C]=e[C]||[],e[C].push(p);const S=c[3]||"";S&&S.split(",").map(T=>T.trim()).filter(Boolean).forEach(T=>re(p,T,p.name,e.SUMMARY.FACTION_KEYWORD||"",p.name,!0));const b=[];let g=o+1;for(;g<t.length;){const T=t[g]||"";if(!T.trim()||s.test(T.trim().toUpperCase())||u.test(T.trim())||!/^\s+/.test(T)&&!n.test(T))break;b.push(T),g++}const y=(()=>{for(let T=0;T<b.length;T++){const k=b[T];if(!k.match(n))continue;const I=X(k);for(let M=T+1;M<b.length;M++){const D=b[M];if(!D.trim()||X(D)<=I)break;if(n.test(D))return!0}}return!1})();let _=null,w=0;for(let T=0;T<b.length;T++){const k=b[T],E=k.trim(),I=k.match(n),M=X(k);if(I){const D=I[1].trim(),B=D.match(/^(.*?)\s*\(\+?\s*\d+\s*(?:pts?|points)\)\s*$/i);if(/^Enhancement:/i.test(D)){Ye(D.replace(/^Enhancement:\s*/i,"").trim(),p,e.SUMMARY.FACTION_KEYWORD||"");continue}else if(B){Ye(D.trim(),p,e.SUMMARY.FACTION_KEYWORD||"");continue}if(y){if(_&&typeof w=="number"&&M>w){const $=D.split(",").map(q=>q.trim()).filter(Boolean);for(let q of $){const z=q.match(/^(.+?)\s*\(([^)]+)\)\s*$/);if(z){const O=z[1].trim(),V=z[2].trim();if(R(O)===R(_.name)){const ue=$.some(De=>R(De)===R(V)),Q=(_.items||[]).some(De=>R(De.name||"")===R(V));if(ue||Q)continue;const ve=ne(q),ae=parseInt(String(ve.quantity||"1x").replace(/[^0-9]/g,""),10)||1;re(_,V,_.name,e.SUMMARY.FACTION_KEYWORD||"",p.name,!1,"wargear",ae);continue}}re(_,q,_.name,e.SUMMARY.FACTION_KEYWORD||"",p.name,!0)}continue}_=null;const v=D.match(/^(\d+x?)\s+(.*)$/i),W=v?v[1]:"1x";let H=v?v[2].trim():D;try{const $=H.match(/^(.+?)\s*\(([^)]+)\)\s*$/);if($){const q=$[1].trim(),z=$[2].trim(),O=R(q),V=R(p.name||""),ue=R(unitTopName||p.name||"");if(O&&(O===V||V.startsWith(O)||O.startsWith(V)||ue.startsWith(O)||O.startsWith(ue))){H=q;const Q={quantity:W,name:H,items:[],type:"subunit"};Q._deferredParenthetical=z,Q._deferredParentheticalQty=parseInt(String(W||"1x").replace(/[^0-9]/g,""),10)||1,p.items=p.items||[],p.items.push(Q),_=Q,w=M;continue}}}catch($){}const le={quantity:W,name:H,items:[],type:"subunit"};p.items=p.items||[],p.items.push(le),_=le,w=M;continue}re(p,D,p.name,e.SUMMARY.FACTION_KEYWORD||"","wargear",1);continue}if(_&&M>w){re(_,E,_.name,e.SUMMARY.FACTION_KEYWORD||"",p.name,!0);continue}re(p,E,p.name,e.SUMMARY.FACTION_KEYWORD||"","wargear",1)}o=g-1;continue}}function m(o,l){if(!(!o||typeof o!="object")){if(typeof o.name!="string"&&(o.name=""),typeof o.quantity!="string"&&(o.quantity=o.quantity?String(o.quantity):"1x"),typeof o.type!="string"&&(o.type=o.type||"wargear"),typeof o.nameshort!="string"&&(o.nameshort=o.nameshort||""),Array.isArray(o.items)||(o.items=[]),/^Enhancement:/i.test(o.name)){const a=o.name.replace(/^Enhancement:\s*/i,"").trim();o.type="special",o.nameshort=o.nameshort||(()=>{const c=a.match(/\(([^)]+)\)$/),r=c?` (${c[1]})`:"";return`E: ${a.replace(/\s*\([^)]+\)$/,"").trim().split(/\s+/).map(d=>d[0]?d[0].toUpperCase():"").join("")}${r}`.trim()})(),o.name=`Enhancement: ${yt(a.replace(/\s*\([^)]+\)$/,"").trim())}`}else o.name=l?o.name:yt(o.name);R(o.name)==="warlord"&&(o.type="special"),o.items=(o.items||[]).map(a=>{if(!a)return null;if(typeof a=="string"){const c={quantity:"1x",name:a.trim(),items:[],type:/^Enhancement:/i.test(a)?"special":"wargear",nameshort:""};return m(c,o.name),c}return m(a,o.name),a}).filter(Boolean)}}for(const o of["CHARACTER","OTHER DATASHEETS"])if(Array.isArray(e[o]))for(const l of e[o]){m(l);const a=(l.items||[]).filter(r=>r&&r.type==="subunit");if(a.length>0)if(a.every(i=>R(i.name||"")===R(l.name||""))){const i=new Map;let h=0;for(const d of a){const A=parseInt(String(d.quantity||"1x").replace(/x/i,""),10)||1;h+=A;for(const p of d.items||[]){const C={items:[]};re(C,`${p.quantity||"1x"} ${p.name}`,l.name,e.SUMMARY.FACTION_KEYWORD||"",p.type||"wargear",1);for(const S of C.items){const b=R(S.name||"");if(i.has(b)){const g=i.get(b),y=parseInt(String(g.quantity||"1x").replace(/x/i,""),10)||0,_=parseInt(String(S.quantity||"1x").replace(/x/i,""),10)||0;g.quantity=`${y+_}x`}else i.set(b,S)}}}l.items=Array.from(i.values()),h>0&&(l.quantity=`${h}x`),l.isComplex=!1}else{const i=a.reduce((h,d)=>h+(parseInt(String(d.quantity||"1x").replace(/x/i,""),10)||0),0);i>0&&(l.quantity=`${i}x`),l.isComplex=!1}else l.isComplex=!1;if(Array.isArray(l.items)&&l.items.length===1&&l.items[0]&&l.items[0].type==="subunit"){const r=l.items[0];Array.isArray(r.items)&&r.items.length>0&&(l.items=r.items.slice(),l.isComplex=!1)}Array.isArray(l.items)&&l.items.length>0&&K(l.items);const c=(l.items||[]).filter(r=>r&&r.type==="subunit");for(const r of c)Array.isArray(r.items)&&r.items.length>0&&K(r.items)}return ie(e),e}function mr(t){if(!Array.isArray(t))return Ct(t);const e=[];let s=0;for(;s<t.length;s++){const r=String(t[s]||"").trim();if(!r){e.push(r);continue}if(r.startsWith("+")||r.startsWith("&")){e.push(r);continue}break}const u=[],n={};for(const c of e){if(!c)continue;if(c.startsWith("&")){const d=c.replace(/^&\s*/,"").match(/^(.*?)\s*\(on\s+(?:(Char\d+):\s*)?(.*)\)$/i);d&&u.push({enh:d[1].trim(),target:(d[3]||"").trim(),charId:d[2]||null});continue}const i=c.replace(/^\+\s*/,"").match(/^([^:]+):\s*(.*)$/);if(i){const h=i[1].trim().toUpperCase(),d=i[2].trim();if(h==="ENHANCEMENT"){const A=d.match(/^(.*?)\s*\(on\s+(?:(Char\d+):\s*)?(.*)\)$/i);A?u.push({enh:A[1].trim(),target:(A[3]||"").trim(),charId:A[2]||null}):u.push({enh:d,target:null,charId:null})}else if(h==="FACTION KEYWORD"){const A=d.split(" - ");n.faction=A[A.length-1].trim()}else h==="DETACHMENT"?n.detachment=d.replace(/\u00A0/g," "):h==="TOTAL ARMY POINTS"&&(n.points=d)}}const f=t.slice(s),m=[];for(const c of f){if(!c){m.push(c);continue}let r=String(c);r=r.replace(/^\s*Char\d+:\s*/i,"");const i=r.match(/^(.*\))\s*:\s*(.+)$/);i?(m.push(i[1]),m.push("  • "+i[2])):m.push(r)}const o=Ct(m);o.SUMMARY=o.SUMMARY||{},n.faction&&(o.SUMMARY.FACTION_KEYWORD=n.faction),n.detachment&&(o.SUMMARY.DETACHMENT=n.detachment),n.points&&(o.SUMMARY.TOTAL_ARMY_POINTS=n.points);const l=[...o.CHARACTER||[],...o["OTHER DATASHEETS"]||[]],a=c=>{const r=R(String(c||""));for(const i of l){const h=i&&Array.isArray(i.items)?i.items:[];for(const d of h){if(!d||!d.name)continue;const A=String(d.name||"").replace(/^Enhancement:\s*/i,"").replace(/\s*\([^)]*\)\s*$/,"").trim();if(R(A)===r)return!0}}return!1};for(const c of u){if(!c||!c.enh||a(c.enh))continue;let r=null;const i=h=>String(h||"").toLowerCase().replace(/[^a-z0-9 ]/g,"").trim();if(c.charId){const h=parseInt(String(c.charId).replace(/[^0-9]/g,""),10);!Number.isNaN(h)&&h>0&&Array.isArray(o.CHARACTER)&&o.CHARACTER[h-1]&&(r=o.CHARACTER[h-1])}!r&&c.target&&(r=l.find(h=>i(h.name).includes(i(c.target))||i(`${h.quantity} ${h.name}`).includes(i(c.target)))),!r&&l.length===1&&(r=l[0]),r&&Ye(c.enh,r,o.SUMMARY.FACTION_KEYWORD||"")}try{for(const c of["CHARACTER","OTHER DATASHEETS"]){const r=o[c];if(Array.isArray(r))for(const i of r)i&&typeof i=="object"&&Object.prototype.hasOwnProperty.call(i,"type")&&delete i.type}for(const c of["CHARACTER","OTHER DATASHEETS"]){const r=o[c];if(Array.isArray(r)){for(const i of r)if(!(!i||!Array.isArray(i.items))){for(const h of i.items.filter(d=>d&&d.type==="subunit"))if(h&&h._deferredParenthetical)try{delete h._deferredParenthetical,delete h._deferredParentheticalQty}catch(d){}}}}}catch(c){}return ie(o),o}function hr(t){const e={SUMMARY:{},CHARACTER:[],"OTHER DATASHEETS":[]};if(!Array.isArray(t))return e;const s=t.map(a=>String(a||"")).find(a=>a.trim()),u=t.findIndex(a=>String(a||"").trim());if(s){const a=s.split(/\s*-\s*/).map(c=>c.trim()).filter(Boolean);if(e.SUMMARY.FACTION_FAMILY=a[0]||"",e.SUMMARY.FACTION_KEYWORD=a[1]||"",a.length>=3){const r=a[a.length-1].match(/\[\s*(\d{2,5})\s*pts?\s*\]$/i);r?(e.SUMMARY.TOTAL_ARMY_POINTS=`${r[1]}pts`,a.length===3?e.SUMMARY.LIST_TITLE=a[2]:e.SUMMARY.LIST_TITLE=a.slice(2,a.length-1).join(" - ")):e.SUMMARY.LIST_TITLE=a.slice(2).join(" - ")}e.SUMMARY.DISPLAY_FACTION=s.trim()}for(let a=0;a<Math.min(t.length,40);a++){const c=String(t[a]||"").trim();if(!c)continue;const r=c.match(/^Detachment:\s*(.*)$/i);r&&(e.SUMMARY.DETACHMENT=r[1].trim());const i=c.match(/^TOTAL ARMY POINTS:\s*(.*)$/i);i&&(e.SUMMARY.TOTAL_ARMY_POINTS=i[1].trim());const h=c.match(/^FACTION KEYWORD:\s*(.*)$/i);h&&(e.SUMMARY.FACTION_KEYWORD=h[1].trim());const d=c.match(/^Battle Size:\s*(.*)$/i);d&&(e.SUMMARY.BATTLE_SIZE=d[1].trim());const A=c.match(/^#+\s*(?:\+{1,2}\s*)?(.*)\[\s*\d{2,5}\s*pts?\s*\]$/i);if(A&&!e.SUMMARY.LIST_TITLE){const p=A[1].trim();/Army\s+Roster/i.test(p)||/\+\+/.test(p)?e.SUMMARY.LIST_TITLE="":e.SUMMARY.LIST_TITLE=p}}if(!e.SUMMARY.FACTION_KEYWORD&&e.SUMMARY.DISPLAY_FACTION){const a=e.SUMMARY.DISPLAY_FACTION.split(" - ");a.length>=2?e.SUMMARY.FACTION_KEYWORD=a[1].trim():e.SUMMARY.FACTION_KEYWORD=e.SUMMARY.DISPLAY_FACTION.replace(/\s*\[.*$/,"").trim()}const n=/^(?:(\d+)x?\s+)?(.+?)\s*\[\s*(\d{1,4})\s*pts?\s*\]\s*(?::\s*(.*))?$/i,f=/^\s*(?:•|\-|\+)\s*(.*)$/;let m=null,o=null;for(let a=0;a<t.length;a++){const c=String(t[a]||""),r=c.trim();if(!r||a===u)continue;if(r.startsWith("#")){const d=r.match(/^#+\s*(.+?)\s*(?:\[\s*\d+\s*pts?\s*\])?$/i);if(d){const A=d[1].trim();/character|epic|hero|hq/i.test(A)?m="CHARACTER":m="OTHER DATASHEETS"}continue}const i=r.match(n);if(i){const d=i[1]?`${i[1]}x`:"1x",A=(i[2]||"").trim(),p=parseInt(i[3],10)||0,C=i[4]||"",S={quantity:d,name:A,points:p,items:[],isComplex:!1,nameshort:""};m||(m="OTHER DATASHEETS"),e[m]=e[m]||[],e[m].push(S),o=S,C&&C.split(",").map(b=>b.trim()).filter(Boolean).forEach(b=>{l(o,b,o.name,e.SUMMARY.FACTION_KEYWORD||"",o.name,!0)});continue}const h=c.match(f);if(h&&o){const d=h[1].trim(),A=d.match(/^(\d+)\s+with\s+(.*)$/i);if(A&&o){const S=parseInt(A[1],10)||1,b=A[2],g=o.items&&o.items.length>0?o.items[o.items.length-1]:o;b.split(",").map(y=>y.trim()).filter(Boolean).forEach(y=>l(g,`${S}x ${y}`,g.name,e.SUMMARY.FACTION_KEYWORD||"",o.name,!0));continue}const p=d.match(/^(\d+x?)\s+([^:]+):\s*(.*)$/i);if(p){const S=p[1];let b=p[2].trim();const g=p[3]||"";b=b.replace(/\s+w\/.*$/i,"").trim();const y={quantity:S,name:b,items:[],type:"subunit"};if(g){const _=g.match(/^(\d+)\s+with\s+(.*)$/i);if(_){const w=parseInt(_[1],10)||1;_[2].split(",").map(k=>k.trim()).filter(Boolean).forEach(k=>l(y,`${w}x ${k}`,y.name,e.SUMMARY.FACTION_KEYWORD||"",o.name,!0))}else g.split(",").map(w=>w.trim()).filter(Boolean).forEach(w=>l(y,w,y.name,e.SUMMARY.FACTION_KEYWORD||"",o.name,!0))}o.items=o.items||[],o.items.push(y);continue}const C=d.match(/^(\d+x?)\s+(.*)$/i);if(C&&o){let S=C[2].trim();S=S.replace(/\s+w\/.*$/i,"").trim();const b={quantity:C[1],name:S,items:[],type:"subunit"};o.items=o.items||[],o.items.push(b);continue}l(o,d,o.name,e.SUMMARY.FACTION_KEYWORD||"",o.name,!0);continue}}function l(a,c,r,i,h="",d=!1,A="wargear"){if(!a)return;a.items=a.items||[];const p=String(c||"").trim(),C=ne(p),S=C.quantity?String(C.quantity):"1x",b=/^\s*\d+x?\s+/i.test(p);let g=C.name||"";const y=g.match(/^(.*?)\s*\(([^)]+)\)$/);if(y){const E=(y[1]||"").trim(),I=(y[2]||"").trim();(/\bDrone\b/i.test(E)||/\bDrone\b/i.test(g))&&(g=I)}const _=R(g);if(d){const E=String(r||""),I=String(h||"");if(R(E)===R(g)||I&&R(I)===R(g))return}const w=parseInt(String(S||"1x").replace(/x/i,""),10)||1;let T=w;if(a&&a.type==="subunit"){const E=parseInt(String(a.quantity||"1x").replace(/[^0-9]/g,""),10)||1;T=b?w:E}const k=a.items.find(E=>R(E.name||"")===_);if(k){const E=parseInt(String(k.quantity||"1x").replace(/x/i,""),10)||0;k.quantity=`${E+T}x`}else{const E=R(g)==="warlord"?"special":A;a.items.push({quantity:`${T}x`,name:g,items:[],type:E,nameshort:""})}}for(const a of["CHARACTER","OTHER DATASHEETS"])if(Array.isArray(e[a]))for(const c of e[a]){if(!c||!Array.isArray(c.items)||c.items.length===0)continue;if(c.items.filter(h=>h&&h.type==="subunit").length>1){const h=new Map,d=[];for(const A of c.items){if(!A||A.type!=="subunit"){d.push(A);continue}const p=R(A.name||"");if(!h.has(p))h.set(p,{quantity:A.quantity||"1x",name:A.name,items:Array.isArray(A.items)?A.items.slice():[],type:"subunit"});else{const C=h.get(p),S=parseInt(String(C.quantity||"1x").replace(/[^0-9]/g,""),10)||0,b=parseInt(String(A.quantity||"1x").replace(/[^0-9]/g,""),10)||0;C.quantity=`${S+b}x`;const g=new Map;for(const y of C.items||[]){const _=R(y&&y.name||"");_&&g.set(_,{quantity:y.quantity||"1x",name:y.name,items:[],type:y.type||"wargear",nameshort:y.nameshort||""})}for(const y of A.items||[]){const _=R(y&&y.name||"");if(_)if(g.has(_)){const w=g.get(_),T=parseInt(String(w.quantity||"1x").replace(/[^0-9]/g,""),10)||0,k=parseInt(String(y.quantity||"1x").replace(/[^0-9]/g,""),10)||0;w.quantity=`${T+k}x`}else g.set(_,{quantity:y.quantity||"1x",name:y.name,items:[],type:y.type||"wargear",nameshort:y.nameshort||""})}C.items=Array.from(g.values())}}c.items=[...d,...Array.from(h.values())]}c&&Array.isArray(c.items)&&c.items.length>0&&K(c.items);const i=c&&Array.isArray(c.items)?c.items.filter(h=>h&&h.type==="subunit"):[];for(const h of i)h&&Array.isArray(h.items)&&h.items.length>0&&K(h.items)}return ie(e),e}function fr(t,e=40){return(Array.isArray(t)?t:String(t||"").split(/\r?\n/)).slice(0,e)}function pr(t){const e=Array.isArray(t)?t:String(t||"").split(/\r?\n/),s=fr(e,40),u=e.join(`
`),n={NRNR:{score:0,breakdown:{},maxScore:8},"WTC-Compact":{score:0,breakdown:{},maxScore:8},WTC:{score:0,breakdown:{},maxScore:8},GWAPP:{score:0,breakdown:{},maxScore:7},"NR-GW":{score:0,breakdown:{},maxScore:7},LF:{score:0,breakdown:{},maxScore:7}},f=s.some(v=>/-\s*\[\s*\d{2,5}\s*pts?\s*\]$/i.test(v)),m=s.some(v=>/^#{1,3}\s+/.test(v)),o=s.some(v=>/^\s*#?\s*\+\+\s*Army Roster\s*\+\+/i.test(v)),l=s.some(v=>/^\s*##\s+/.test(v)),a=/(.+?)\s*[\(\[]\s*([0-9]{1,4})\s*(?:pts|points)\s*[\)\]]/i,c=u.match(new RegExp(a.source,"g"))||[],r=u.match(/^[ \t]*(?:•|\-|\+)\s*(?:\d+x?)\s+[^:]+:/gmi)||[],i=u.match(/\b[A-Za-z0-9\-\'’ ]+\s*\([^\)]+\)/g)||[],h=/(^|\n)\s*Char\d+:.*\(\s*\d{1,4}\s*(?:pts|points)\s*\)\s*:\s*/i,d=(u.match(new RegExp(h.source,"gi"))||[]).length,A=s.some(v=>/^(List Name|Factions Used|Army Points|Detachment Rule):/i.test(v.trim())),p=s.some(v=>/-\s*\(\s*\d+\s*Points?\s*\)\s*$/i.test(v)),C=u.match(/^(Epic Hero|Epic Heroes|Character|Characters|Battleline|Infantry|Beast|Vehicle|Dedicated Transport|Other Datasheets):\s*$/gmi)||[],S=(u.match(/^\s*•\s*(?:E:|Enhancement:)/gmi)||[]).length,b=(u.match(/^\s*•\s+/gmi)||[]).length;A&&(n.LF.score+=4,n.LF.breakdown.headerKeys=4),p&&(n.LF.score+=4,n.LF.breakdown.titleLine=4),C.length>=2&&(n.LF.score+=3,n.LF.breakdown.sectionColons=C.length),b>5&&(n.LF.score+=1,n.LF.breakdown.bullets=b),S>0&&(n.LF.score+=1,n.LF.breakdown.enhancementLines=S),(A||p||C.length>=2)&&(n.NRNR.score-=1,n.WTC.score-=1,n["WTC-Compact"].score-=1,n.GWAPP.score-=1,n["NR-GW"].score-=3),f&&(n.NRNR.score+=2,n.NRNR.breakdown.titleWithBracketedPts=2),m&&(n.NRNR.score+=3,n.NRNR.breakdown.markdownHeading=3),o&&(n.NRNR.score+=2,n.NRNR.breakdown.armyRoster=2),l&&(n.NRNR.score+=1,n.NRNR.breakdown.doubleHashSections=1),c.length>=3&&(n.NRNR.score+=1,n.NRNR.breakdown.unitLines=1),r.length>0&&(n.NRNR.score+=1,n.NRNR.breakdown.bulletWithQty=r.length),i.length>0&&(n.NRNR.score+=.5,n.NRNR.breakdown.parenItem=i.length);const g=s.join(`
`);/^[ \t]*[+&]/m.test(g)&&(n["WTC-Compact"].score+=3,n["WTC-Compact"].breakdown.headerPlusAmp=3),/(FACTION KEYWORD|DETACHMENT|TOTAL ARMY POINTS)/i.test(g)&&(n["WTC-Compact"].score+=2,n["WTC-Compact"].breakdown.headerKeys=2),c.length>=2&&(n["WTC-Compact"].score+=1,n["WTC-Compact"].breakdown.unitLines=1),d>0&&(n["WTC-Compact"].score+=5,n["WTC-Compact"].breakdown.inlineCharList=d),/^\s*[+&]/m.test(g)&&(n.WTC.score+=1,n.WTC.breakdown.headerPlusAmp=1),/NUMBER OF UNITS:/i.test(g)&&(n.WTC.score+=2,n.WTC.breakdown.numberOfUnits=2);const y=(u.match(/(^|\n)\s*Char\d+:/gi)||[]).length>0;y&&(n.WTC.score+=3,n.WTC.breakdown.charMarkers=3),(m||o||l)&&(n.WTC.score-=2,n.WTC.breakdown.nrnrPenalty=-2,n["WTC-Compact"].score-=1,n["WTC-Compact"].breakdown.nrnrPenalty=-1);const _=(u.match(/^\s*\d+\s+with\s+/gmi)||[]).length;_>0&&(n.WTC.score+=2,n.WTC.breakdown.withLines=_,n["WTC-Compact"].score+=2,n["WTC-Compact"].breakdown.withLines=_),s.some(v=>/^(?:CHARACTER|OTHER DATASHEETS|CHARACTERS)\s*$/.test((v||"").trim()))&&(n.WTC.score+=1,n.WTC.breakdown.sectionHeaders=1),y&&(n["WTC-Compact"].score-=1,n["WTC-Compact"].breakdown.charMarkerPenalty=-1),d>0&&(n.WTC.score-=2,n.WTC.breakdown.compactInlinePenalty=-2);const w=/Exported with/i.test(u);(/Exported with/i.test(g)||w)&&(n.GWAPP.score+=6,n.GWAPP.breakdown.exportedWith=6),/\b(CHARACTERS|BATTLELINE|OTHER DATASHEETS|ALLIED UNITS)\b/i.test(u)&&(n.GWAPP.score+=2,n.GWAPP.breakdown.sectionHeaders=2),/\(\s*\d+\s*(?:pts|points)\s*\)/i.test(g)&&(n.GWAPP.score+=1,n.GWAPP.breakdown.titleParenPts=1),w&&(n["NR-GW"].score-=4,n["NR-GW"].breakdown.gwappPenalty=-4),/^\s*Strike Force\s*\(\s*\d{2,5}\s*points\s*\)/mi.test(u)&&(n.GWAPP.score+=3,n.GWAPP.breakdown.strikeForce=3),/\b(CHARACTERS|BATTLELINE|OTHER DATASHEETS|DEDICATED TRANSPORTS)\b/i.test(u)&&(n["NR-GW"].score+=2,n["NR-GW"].breakdown.sectionHeaders=2);const T=(u.match(/^[ \t]*(?:•|\u2022|◦|\-|\+)\s+/gmi)||[]).length;T>0&&!w&&(n["NR-GW"].score+=1,n["NR-GW"].breakdown.bulletCount=T),i.length>0&&!w&&(n["NR-GW"].score+=1,n["NR-GW"].breakdown.parenItem=i.length);const k=(u.match(/^[ \t]*(?:•|\u2022|◦|\-|\+)\s*\d+x?\s+[A-Za-z0-9\-\'’]+/gmi)||[]).length;k>=3&&!y&&!w&&(n["NR-GW"].score+=3,n["NR-GW"].breakdown.bulletQty=k);const E=/^(?:\s*)\d+x?\s+.*\(\s*\d{1,4}\s*(?:pts|points)\s*\)/i,I=e.filter(v=>E.test(v)).length;if(I>=2&&!y&&!w&&(n["NR-GW"].score+=2,n["NR-GW"].breakdown.unitLinesNoChar=I),!y&&!w&&(k>=3||I>=2)&&(n.WTC.score-=2,n.WTC.breakdown.nrGwPenalty=-2,n["WTC-Compact"].score-=2,n["WTC-Compact"].breakdown.nrGwPenalty=-2),(m||o)&&(n["NR-GW"].score-=1,n["NR-GW"].breakdown.nrnrPenalty2=-1),u.indexOf("’")!==-1)for(const v of Object.keys(n))n[v].score+=.5,n[v].breakdown=n[v].breakdown||{},n[v].breakdown.unicodeApostrophe=.5;const M={};for(const v of Object.keys(n)){const W=n[v],H=Math.max(0,Math.min(1,W.score/(W.maxScore||8)));M[v]={score:W.score,confidence:H,scoreBreakdown:W.breakdown}}const D=Object.keys(M).sort((v,W)=>M[W].score-M[v].score)[0],B=M[D]||{score:0,confidence:0};return{format:D,confidence:B.confidence,score:B.score,scoreBreakdown:B.scoreBreakdown,all:M}}function Ft(t){const e=String(t||"").trim().match(/^(\d+)\s+(.*)$/);return e&&!/^\d+x\b/i.test(String(t||""))?`${e[1]}x ${e[2]}`:t}function Ot(t){const e=String(t||"").trim().replace(/^E:\s*/i,"").replace(/^Enhancement:\s*/i,"").trim(),s=e.match(/\(([^)]*pts?[^)]*)\)\s*$/i),u=e.replace(/\s*\([^)]*\)\s*$/,"").trim(),f=`E: ${u.split(/\s+/).map(m=>m[0]?m[0].toUpperCase():"").join("")}${s?` (${s[1].trim()})`:""}`.trim();return{quantity:"1x",name:`Enhancement: ${u}`,nameshort:f,items:[],type:"special"}}function dr(t,e){if(!t)return;t.items=t.items||[];const s=Ft(String(e||"").trim());if(/^(E:|Enhancement:)/i.test(s)){const n=Ot(s),f=R(n.name.replace(/^Enhancement:\s*/i,""));(t.items||[]).some(o=>/^Enhancement:/i.test(o.name||"")&&R(String(o.name).replace(/^Enhancement:\s*/i,"").replace(/\s*\([^)]*\)\s*$/,""))===f)||t.items.push(n);return}const u=s.split(",").map(n=>n.trim()).filter(Boolean);for(const n of u){const f=ne(n.replace(/^with\s+/i,"")),m=f.quantity||"1x",o=f.name||"";if(!o)continue;const l=R(o),a=t.items.find(c=>R(c.name||"")===l);if(a){const c=parseInt(String(a.quantity||"1x").replace(/[^0-9]/g,""),10)||0,r=parseInt(String(m).replace(/[^0-9]/g,""),10)||0;a.quantity=`${c+r}x`}else t.items.push({quantity:m,name:o,items:[],type:"wargear",nameshort:""})}}function gr(t,e){const s=t[e]||"",u=X(s);for(let n=e+1;n<t.length;n++){const f=t[n]||"";if(!f.trim())continue;const m=X(f),o=/^\s*•\s*/.test(f);return m>u&&o}return!1}function yr(t){const e={SUMMARY:{},CHARACTER:[],"OTHER DATASHEETS":[]};if(!Array.isArray(t))return e;const s=t.slice(0,30).map(i=>String(i||""));let u=!1;for(const i of s){const h=i.match(/^\s*([A-Za-z ][A-Za-z ]*):\s*(.*)$/);if(!h)continue;const d=h[1].trim().toLowerCase(),A=h[2].trim();if(d==="list name"&&(e.SUMMARY.LIST_TITLE=A,u=!0),d==="factions used"&&(e.SUMMARY.FACTION_KEYWORD=A,u=!0),d==="army points"){const p=parseInt(A.replace(/[^0-9]/g,""),10);p&&(e.SUMMARY.TOTAL_ARMY_POINTS=`${p}pts`,u=!0)}d==="detachment rule"&&(e.SUMMARY.DETACHMENT=A,u=!0)}if(!u){const i=t.find(h=>String(h||"").trim());if(i){const h=String(i).match(/^(.*?)\s*-\s*(.*?)\s*-\s*(.*?)\s*\((\d+)\s*Points?\)/i);h&&(e.SUMMARY.LIST_TITLE=h[1].trim(),e.SUMMARY.FACTION_KEYWORD=h[2].trim(),e.SUMMARY.DETACHMENT=h[3].trim(),e.SUMMARY.TOTAL_ARMY_POINTS=`${parseInt(h[4],10)}pts`)}}const n=/^\s*([A-Za-z ]+):\s*$/,f=/^\s*(.*?)\s*\((\d+)\s*pts?\)\s*$/i,m=/^\s*•\s*(.*)$/;let o=null;const l=[];for(let i=0;i<t.length;i++){const h=String(t[i]||"");if(!h.trim())continue;const A=h.match(n);if(A){const _=A[1].trim().toLowerCase();o=/hero|character/.test(_)?"CHARACTER":"OTHER DATASHEETS",l.length=0;continue}const p=h.match(f);if(p&&X(h)===0){const _=p[1].trim(),w=parseInt(p[2],10)||0,T={quantity:"1x",name:_,points:w,items:[],isComplex:!1,nameshort:""},k=o==="CHARACTER"?"CHARACTER":"OTHER DATASHEETS";e[k]=e[k]||[],e[k].push(T),l.length=0,l.push({indent:0,node:T});continue}const C=h.match(m);if(!C)continue;const S=C[1].trim(),b=X(h);for(;l.length>0&&b<=l[l.length-1].indent;)l.pop();const g=l.length>0?l[l.length-1].node:null;if(!g||/^B:\s*/i.test(S))continue;if(/^(E:|Enhancement:)/i.test(S)){const _=Ot(S),w=l[0]?l[0].node:g;w.items=w.items||[],(w.items||[]).some(k=>/^Enhancement:/i.test(k.name||"")&&R(k.name)===R(_.name))||w.items.push(_);continue}if(gr(t,i)){const _=ne(Ft(S));let w=_.name||"";w=w.replace(/\s+w\/.*$/i,"").trim();const T={quantity:_.quantity||"1x",name:w,items:[],type:"subunit"};g.items=g.items||[],g.items.push(T),l.push({indent:b,node:T});continue}dr(g,S)}function a(i){const h=parseInt(String(i||"1x").replace(/[^0-9]/g,""),10);return Number.isFinite(h)&&h>0?h:1}for(const i of["CHARACTER","OTHER DATASHEETS"]){const h=e[i]||[];for(const d of h){const A=Array.isArray(d.items)?d.items:[],p=A.filter(g=>g&&g.type==="subunit");if(p.length<=1)continue;const C=new Map;for(const g of p){const y=R((g.name||"").replace(/\s+w\/.*/i,"").trim());C.has(y)||C.set(y,{name:g.name,qty:0,wargear:new Map});const _=C.get(y);_.qty+=a(g.quantity);const w=Array.isArray(g.items)?g.items:[];for(const T of w){const k=R(T.name||""),E=_.wargear.get(k)||{name:T.name,qty:0,type:T.type||"wargear"};E.qty+=a(T.quantity),_.wargear.has(k),_.wargear.set(k,E)}}const S=A.filter(g=>!(g&&g.type==="subunit")),b=[];for(const[,g]of C){const y={quantity:`${g.qty}x`,name:g.name,items:[],type:"subunit"};for(const[,_]of g.wargear)y.items.push({quantity:`${_.qty}x`,name:_.name,items:[],type:_.type||"wargear",nameshort:""});b.push(y)}d.items=[...S,...b]}}const c=e.SUMMARY&&e.SUMMARY.FACTION_KEYWORD?String(e.SUMMARY.FACTION_KEYWORD).trim():"";function r(i){if(!i||!c)return i;const h=new RegExp("^"+c.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")+"\\s+","i");return String(i).replace(h,"").trim()}if(c)for(const i of["CHARACTER","OTHER DATASHEETS"]){const h=e[i]||[];for(const d of h){d.name=r(d.name);const A=(d.items||[]).filter(p=>p&&p.type==="subunit");for(const p of A)p.name=r(p.name)}}for(const i of["CHARACTER","OTHER DATASHEETS"]){const h=e[i]||[];for(const d of h){Array.isArray(d.items)&&d.items.length>0&&K(d.items);const A=(d.items||[]).filter(p=>p&&p.type==="subunit");for(const p of A)Array.isArray(p.items)&&p.items.length>0&&K(p.items)}}return ie(e),e}function Cr(t){try{const e=pr(t).format;return e==="NRNR"?"NRNR":e==="WTC-Compact"?"WTC_COMPACT":e==="WTC"?"WTC":e==="GWAPP"?"GW_APP":e==="NR-GW"?"NR_GW":e==="LF"?"LF":"UNKNOWN"}catch(e){const s=Array.isArray(t)?t.slice(0,25):[],u=s.some(f=>/^\s*\+\s*FACTION KEYWORD:/i.test(f)||/^\s*\+\s*DETACHMENT:/i.test(f)),n=s.some(f=>/^(?:CHARACTERS|CHARACTER|BATTLELINE|OTHER DATASHEETS|ALLIED UNITS|DEDICATED TRANSPORTS)$/i.test((f||"").trim().toUpperCase()));return u&&n?"NR_GW":s.some(f=>/^\s*\+\s*FACTION KEYWORD:/i.test(f))?"WTC_COMPACT":n?"GW_APP":"UNKNOWN"}}const N=typeof document!="undefined"&&document;N&&document.getElementById("inputText");N&&document.getElementById("unabbreviatedOutput");N&&document.getElementById("compactedOutput");N&&document.getElementById("markdownPreviewOutput");N&&document.getElementById("debugOutput");N&&document.getElementById("parseButton");N&&document.getElementById("resetButton");N&&document.getElementById("toggleDebugButton");N&&document.getElementById("copyExtendedButton");N&&document.getElementById("outputFormatSelect");N&&document.getElementById("copyPreviewButton");N&&document.getElementById("customColorPickers");N&&document.getElementById("inputCharCount");N&&document.getElementById("extendedCharCount");N&&document.getElementById("compactCharCount");N&&document.getElementById("markdownPreviewCharCount");N&&document.getElementById("copyPopup");typeof AnsiUp!="undefined"&&new AnsiUp;function Sr(){const t=document.getElementById("multilineHeaderCheckbox");return t?t.checked:!1}function qe(t){if(!t)return null;const s=t.replace(/\(.*?\)/g,"").replace(/[\-]/g," ").replace(/["'`.,;:?!]/g,"").trim().split(/\s+/).filter(Boolean);return s.length===0?null:s.length===1?s[0].slice(0,2).toUpperCase():s.map(n=>{const f=n.toString().toLowerCase();return f==="and"?"&":f==="of"?"o":n[0].toUpperCase()}).join("")}function St(t){return qe(t)}function Ar(t){const e=Object.create(null),s=Object.create(null),u=m=>!m||!m.type?1:m.type==="wargear"?3:m.type==="special"?2:1,n=(m,o)=>{const l=(o||"").replace(/\(.*?\)/g,"").replace(/[\-]/g," ").trim().split(/\s+/)[0]||"";let a=1;for(;;){const c=l.length>1?l.slice(1,1+a).toLowerCase():String(a),r=m+c;if(!s[r])return r;if(a++,a>100)return m+String(Date.now()).slice(-4)}};if(!t)return{__flat_abbr:e};const f=m=>{if(m){if(Array.isArray(m)){m.forEach(o=>f(o));return}if(m.items&&Array.isArray(m.items))for(const o of m.items){if(!o||!o.name)continue;const l=o.name.toString().trim(),a=l.toLowerCase();if(a!=="warlord"){if(o.type==="special"&&l.toLowerCase().startsWith("enhancement:")){const c=l.replace(/^Enhancement:\s*/i,"").trim(),r=c.replace(/\(.*?\)/g,"").trim(),i=qe(r||c);if(i&&i.toUpperCase()!=="NULL"){let h=i;const d=2;if(s[h]){const A=s[h];if(d>A.priority){const p=n(h,A.name);(A.keys||[]).forEach(C=>{e[C]=p}),s[p]={name:A.name,keys:A.keys,priority:A.priority},e[a]=h,s[h]={name:l,keys:[a],priority:d}}else{const p=n(h,l);e[a]=p,s[p]={name:l,keys:[a],priority:d}}}else e[a]=h,s[h]={name:l,keys:[a],priority:d};c&&c.toLowerCase()!==a&&(e[c.toLowerCase()]=e[a],s[e[a]].keys.push(c.toLowerCase())),r&&r.toLowerCase()!==a&&r.toLowerCase()!==c.toLowerCase()&&(e[r.toLowerCase()]=e[a],s[e[a]].keys.push(r.toLowerCase()))}}if(o.nameshort&&typeof o.nameshort=="string"&&o.nameshort.trim().length>0){let c=o.nameshort.trim();const r=u(o);if(s[c]){const i=s[c];if(r>i.priority){const h=n(c,i.name);(i.keys||[]).forEach(d=>{e[d]=h}),s[h]={name:i.name,keys:i.keys,priority:i.priority},e[a]=c,s[c]={name:l,keys:[a],priority:r}}else{const h=n(c,l);e[a]=h,s[h]={name:l,keys:[a],priority:r}}}else e[a]=c,s[c]={name:l,keys:[a],priority:r}}else if(!e[a]){const c=qe(l);if(c&&c.toUpperCase()!=="NULL"){let r=c;const i=u(o);if(s[r]){const h=s[r];if(i>h.priority){const d=n(r,h.name);(h.keys||[]).forEach(A=>{e[A]=d}),s[d]={name:h.name,keys:h.keys,priority:h.priority},e[a]=r,s[r]={name:l,keys:[a],priority:i}}else{const d=n(r,l);e[a]=d,s[d]={name:l,keys:[a],priority:i}}}else e[a]=r,s[r]={name:l,keys:[a],priority:i}}}o.items&&f(o.items)}}}};for(const m of Object.keys(t||{})){if(m==="SUMMARY")continue;const o=t[m];f(o)}return{__flat_abbr:e}}const _r={"World Eaters":{unit:"red",subunit:"grey",wargear:"yellow",points:"green",header:"red"},"Adepta Sororitas":{unit:"white",subunit:"grey",wargear:"red",points:"yellow",header:"white"},"Adeptus Custodes":{unit:"yellow",subunit:"red",wargear:"white",points:"yellow",header:"yellow"},"Adeptus Mechanicus":{unit:"red",subunit:"grey",wargear:"white",points:"green",header:"red"},"Adeptus Titanicus":{unit:"white",subunit:"grey",wargear:"blue",points:"yellow",header:"yellow"},Aeldari:{unit:"green",subunit:"blue",wargear:"white",points:"grey",header:"green"},"Astra Militarum":{unit:"grey",subunit:"green",wargear:"cyan",points:"yellow",header:"grey"},"Black Templars":{unit:"white",subunit:"grey",wargear:"black",points:"yellow",header:"white"},"Blood Angels":{unit:"red",subunit:"grey",wargear:"white",points:"yellow",header:"red"},"Chaos Daemons":{unit:"red",subunit:"grey",wargear:"green",points:"yellow",header:"red"},"Chaos Knights":{unit:"red",subunit:"grey",wargear:"blue",points:"yellow",header:"red"},"Chaos Space Marines":{unit:"red",subunit:"grey",wargear:"green",points:"yellow",header:"red"},"Dark Angels":{unit:"green",subunit:"grey",wargear:"white",points:"yellow",header:"green"},"Death Guard":{unit:"green",subunit:"grey",wargear:"blue",points:"yellow",header:"green"},Deathwatch:{unit:"black",subunit:"grey",wargear:"blue",points:"yellow",header:"black"},Drukhari:{unit:"magenta",subunit:"grey",wargear:"cyan",points:"yellow",header:"magenta"},"Emperor's Children":{unit:"magenta",subunit:"grey",wargear:"white",points:"yellow",header:"magenta"},"Genestealer Cults":{unit:"cyan",subunit:"grey",wargear:"green",points:"yellow",header:"cyan"},"Grey Knights":{unit:"white",subunit:"grey",wargear:"blue",points:"yellow",header:"white"},"Imperial Fists":{unit:"yellow",subunit:"grey",wargear:"blue",points:"yellow",header:"yellow"},"Imperial Knights":{unit:"white",subunit:"grey",wargear:"blue",points:"yellow",header:"white"},"Iron Hands":{unit:"grey",subunit:"white",wargear:"grey",points:"white",header:"grey"},"Leagues of Votann":{unit:"white",subunit:"grey",wargear:"blue",points:"yellow",header:"white"},Necrons:{unit:"green",subunit:"grey",wargear:"blue",points:"yellow",header:"green"},Orks:{unit:"green",subunit:"grey",wargear:"blue",points:"yellow",header:"green"},"Raven Guard":{unit:"black",subunit:"grey",wargear:"blue",points:"yellow",header:"black"},Salamanders:{unit:"green",subunit:"grey",wargear:"white",points:"yellow",header:"green"},"Space Marines":{unit:"blue",subunit:"grey",wargear:"white",points:"yellow",header:"blue"},"Space Wolves":{unit:"blue",subunit:"grey",wargear:"white",points:"yellow",header:"blue"},"T'au Empire":{unit:"yellow",subunit:"grey",wargear:"white",points:"Cyan",header:"cyan"},"Thousand Sons":{unit:"magenta",subunit:"grey",wargear:"blue",points:"yellow",header:"magenta"},Tyranids:{unit:"cyan",subunit:"grey",wargear:"green",points:"yellow",header:"cyan"},Ultramarines:{unit:"blue",subunit:"grey",wargear:"white",points:"yellow",header:"blue"},"White Scars":{unit:"white",subunit:"grey",wargear:"red",points:"yellow",header:"white"},"Agents of the Imperium":{unit:"white",subunit:"grey",wargear:"blue",points:"yellow",header:"white"}},Ue=[{hex:"#000000",code:30},{hex:"#FF0000",code:31},{hex:"#00FF00",code:32},{hex:"#FFFF00",code:33},{hex:"#0000FF",code:34},{hex:"#FF00FF",code:35},{hex:"#00FFFF",code:36},{hex:"#FFFFFF",code:37},{hex:"#808080",code:90}],At={black:"#000000",red:"#FF0000",green:"#00FF00",yellow:"#FFFF00",blue:"#0000FF",magenta:"#FF00FF",cyan:"#00FFFF",white:"#FFFFFF",grey:"#808080"},Ke=t=>{const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null},Tr=t=>{const e=Ke(t);if(!e)return 37;let s=37,u=1/0;for(const n of Ue){const f=Ke(n.hex),m=Math.pow(e.r-f.r,2)+Math.pow(e.g-f.g,2)+Math.pow(e.b-f.b,2);m<u&&(u=m,s=n.code)}return s};function ke(t){if(t===null||typeof t!="object")return t;if(Array.isArray(t))return t.map(ke);const e={};for(const[s,u]of Object.entries(t))s!=="_parent"&&(e[s]=ke(u));return e}function Nt(t){const e=o=>{const l=[...new Set(Ue.map(c=>c.code))],a={};for(const c of Object.keys(o||{})){const r=c||"",i=Math.abs(Array.from(r).reduce((b,g)=>b*31+g.charCodeAt(0),0))%l.length,h=l[i],d=b=>l.find(g=>!b.includes(g))||l[0],A=d([h]),p=d([A]),C=d([p]),S=b=>{const g=Ue.find(y=>y.code===b);return g?g.hex:"#FFFFFF"};a[r]={unit:S(h),subunit:S(A),wargear:S(p),points:S(C)}}return a},s=_r||{},u=e(t||{}),n=ce(ce({},u),s),f={},m=o=>{if(!o)return"";try{return o.toString().normalize("NFD").replace(new RegExp("\\p{M}","gu"),"").replace(/[\u2018\u2019\u201B\u2032]/g,"'").replace(/[^\w\s'\-]/g,"").toLowerCase().trim()}catch(l){return o.toString().toLowerCase().trim()}};for(const[o,l]of Object.entries(n)){const a={};["unit","subunit","wargear","points","header"].forEach(c=>{if(!l||l[c]===void 0)return;const r=l[c];typeof r=="string"&&r.startsWith("#")?a[c]=r:typeof r=="string"&&At[r.toString().toLowerCase()]?a[c]=At[r.toString().toLowerCase()]:a[c]=r}),f[o]=a;try{f[o.toString().toLowerCase()]=a}catch(c){}try{f[m(o)]=a}catch(c){}}return f}const Re="__HIDE_ALL_WARGEARS__";function Ge(t){const e=new Map,s=[];function u(l){!l||!l.items||l.items.forEach(a=>{if(a.type==="wargear"){const c=a.name,r=parseInt((a.quantity||"1").toString().replace("x",""),10)||1,i=e.get(c)||{name:c,quantity:0,type:"wargear"};i.quantity+=r,e.set(c,i)}else a.type==="special"&&s.push(a);a.items&&Array.isArray(a.items)&&a.items.length>0&&u(a)})}u(t);const n=Array.from(e.values()).map(l=>We(ce({},l),{quantity:`${l.quantity}x`})),f=[...s,...n],m=f.filter(l=>l.type==="special"),o=f.filter(l=>l.type==="wargear");return K(o),[...m,...o]}function Be(t,e,s){if(!e||!t||t.toString().trim().toLowerCase()==="warlord")return null;const u=(t||"").toLowerCase(),n=o=>o?typeof o=="string"?o:typeof o=="object"&&(o.abbr||o.ABBR)||null:null;try{const o=e.__flat_abbr,l=e.__faction_index;if(o&&o[u]!==void 0)return n(o[u]);const a=s&&(s.DISPLAY_FACTION||s.FACTION_KEYWORD)||null;if(a&&l){const c=a.toString().toLowerCase(),r=l[c]||l[a]||l[a.toLowerCase()]||null;if(r&&r[u]!==void 0)return n(r[u])}}catch(o){}if(e[u])return n(e[u]);const f=s&&(s.DISPLAY_FACTION||s.FACTION_KEYWORD)||null;if(f){const o=[f,f.toLowerCase(),f.toUpperCase()].map(l=>e[l]).filter(Boolean);for(const l of o)if(typeof l=="object"){if(l[u])return n(l[u]);for(const a of Object.keys(l))if(a.toLowerCase()===u)return n(l[a]);if(Array.isArray(l)){for(const a of l)if(a.item&&a.item.toLowerCase()===u||a.name&&a.name.toLowerCase()===u)return n(a.abbr||a.ABBR||a.value||a)}}}const m=[e];for(;m.length;){const o=m.shift();if(o){if(Array.isArray(o)){for(const l of o)if(l&&(l.item||l.name)&&(l.item||l.name).toLowerCase()===u)return n(l.abbr||l.ABBR||l.value||l);continue}if(typeof o=="object")for(const[l,a]of Object.entries(o)){if(l.toLowerCase()===u)return n(a);typeof a=="object"&&m.push(a)}}}return null}function ze(t,e,s,u){if(!t||t.length===0)return"";const n=[],f=[];t.filter(o=>o.type==="special").forEach(o=>{const l=o.name||"";if(l.toString().trim().toLowerCase()==="warlord"){n.push("Warlord");return}if(l.toString().startsWith&&l.toString().startsWith("Enhancement:")){const a=l.toString().replace(/^Enhancement:\s*/i,"").trim(),c=/\(([^)]+)\)/.exec(a);let r="";c&&(r=c[1].replace(/\s*pts\s*/i,"").trim(),r=r.startsWith("+")?`(${r})`:`(${r})`);const i=a.replace(/\(.*?\)/g,"").trim();let h=null;e&&(h=Be(a,s,u)||Be(i,s,u)),!h&&e&&(h=St(i||a));const d=`E: ${h||i}${r?" "+r:""}`;n.push(d);return}n.push(l)}),t.filter(o=>o.type==="wargear").forEach(o=>{const a=(parseInt((o.quantity||"1").toString().replace("x",""),10)||1)>1?`${o.quantity} `:"";let c=null;if(e&&(c=Be(o.name,s,u)),c==="NULL")return;!c&&e&&o.nameshort&&(c=o.nameshort),!c&&e&&(c=St(o.name));const r=e&&c?c:o.name;f.push(`${a}${r}`)});const m=[...n,...f].filter(Boolean);return m.length?` (${m.join(", ")})`:""}function be(t,e,s){if(!t)return[];if(!s)return[];const u=e&&(e.DISPLAY_FACTION||e.FACTION_KEYWORD||e.FACTION)||"",n=a=>{if(!a)return"";try{return a.toString().normalize("NFD").replace(new RegExp("\\p{M}","gu"),"").toLowerCase().trim()}catch(c){return a.toString().toLowerCase().trim()}},f=n(s),m=f.endsWith("s")?f.slice(0,-1):f+"s",o=a=>a===!0?[Re]:Array.isArray(a)?a.length===0?[]:a.map(c=>(c||"").toString().toLowerCase()):[],l=a=>{if(!a)return;const c=n(a);if(Object.prototype.hasOwnProperty.call(t,a))return t[a];for(const[r,i]of Object.entries(t))if(r&&n(r)===c)return i};if(u){const a=[u,(u||"").toString()];for(const c of a){const r=l(c);if(!r)continue;const i=[s,f,m];for(const h of i)if(h!==void 0&&Object.prototype.hasOwnProperty.call(r,h))return o(r[h]);for(const[h,d]of Object.entries(r))if(h&&(n(h)===f||n(h)===m))return o(d)}if(typeof u=="string"&&u.includes(" - ")){const c=u.split(" - ").pop(),r=l(c);if(r){for(const[i,h]of Object.entries(r))if(i&&(n(i)===f||n(i)===m))return o(h)}}}for(const[a,c]of Object.entries(t)){if(!a)continue;const r=n(a);if(r===f||r===m)return o(c);if(typeof c=="object"){if(Object.prototype.hasOwnProperty.call(c,s))return o(c[s]);if(Object.prototype.hasOwnProperty.call(c,f))return o(c[f]);if(Object.prototype.hasOwnProperty.call(c,m))return o(c[m]);for(const[i,h]of Object.entries(c))if(i&&(n(i)===f||n(i)===m))return o(h)}}return[]}function br(t,e){parseInt((t.quantity||"1").toString().replace("x",""),10);const s=(t.name||"").toString(),u=t.points||0,n=(t.items||[]).filter(m=>m.type==="wargear"||m.type==="special").map(m=>({t:m.type,n:m.name,q:parseInt((m.quantity||"1").toString().replace("x",""),10)||1})).sort((m,o)=>m.t.localeCompare(o.t)||m.n.localeCompare(o.n)||m.q-o.q);let f="";if(!e){const m=(t.items||[]).filter(o=>o.type==="subunit").map(o=>({n:o.name,q:parseInt((o.quantity||"1").toString().replace("x",""),10)||1})).sort((o,l)=>o.n.localeCompare(l.n)||o.q-l.q);f=JSON.stringify(m)}return JSON.stringify({name:s,points:u,top:n,subsKey:f})}function $t(t,e,s){if(!s)return t;const u=new Map;for(const f of t){const m=br(f,e);u.has(m)||u.set(m,[]),u.get(m).push(f)}const n=[];for(const[f,m]of u.entries()){if(m.length===1){const a=ke(m[0]);a.__groupCount=1,a.__unitSize=parseInt((a.quantity||"1").toString().replace("x",""),10)||1,n.push(a);continue}const o=ke(m[0]),l=parseInt((o.quantity||"1").toString().replace("x",""),10)||1;o.__groupCount=m.length,o.__unitSize=l,n.push(o)}return n}function _t(t,e,s,u,n,f=!0,m=!1){var r,i;let o="",l="";const a=((r=t.SUMMARY)==null?void 0:r.DISPLAY_FACTION)||((i=t.SUMMARY)==null?void 0:i.FACTION_KEYWORD)||"";if(t.SUMMARY){const h=[];if(t.SUMMARY.LIST_TITLE&&h.push(t.SUMMARY.LIST_TITLE),a&&h.push(a),t.SUMMARY.DETACHMENT&&h.push(t.SUMMARY.DETACHMENT),t.SUMMARY.TOTAL_ARMY_POINTS&&h.push(t.SUMMARY.TOTAL_ARMY_POINTS),h.length){const d=h.join(" | ");let A="color:var(--color-text-secondary);";if(f){let p=null;try{const C=Nt(n||{}),S=t.SUMMARY&&(t.SUMMARY.FACTION_KEY||t.SUMMARY.FACTION_KEYWORD||t.SUMMARY.DISPLAY_FACTION)||null,b=y=>{if(!y)return null;try{return y.toString().normalize("NFD").replace(new RegExp("\\p{M}","gu"),"").replace(/[\u2018\u2019\u201B\u2032]/g,"'").replace(/[^\w\s'\-]/g,"").toLowerCase().trim()}catch(_){return y.toString().toLowerCase()}},g=S?C[S]||C[S.toString().toLowerCase()]||C[b(S)]:null;g&&g.header&&(p=g.header)}catch(C){}A=p?`color:${p};`:"color:var(--color-text-secondary);"}o+=`<div style="padding-bottom:0.5rem;border-bottom:1px solid var(--color-border);"><p style="font-size:0.75rem;margin-bottom:0.25rem;${A}font-weight:600;">${d}</p></div>`,l+=d+`

`}}o+='<div style="margin-top:0.5rem;">';const c="•";for(const h in t){if(h==="SUMMARY"||!Array.isArray(t[h]))continue;const d=e?u:!1;(e?$t(t[h],d,m):t[h]).forEach(p=>{const C=parseInt((p.quantity||"1").toString().replace("x",""),10)||1;let S="";if(e&&m&&(p.__groupCount||0)>1){const y=p.__unitSize||C;S=`${p.__groupCount}x${y} `}else S=C>1?`${C} `:"";if(e){const y=be(n,t.SUMMARY,p.name),w=(p.items||[]).filter(E=>E.type==="wargear"||E.type==="special").filter(E=>E.type==="special"?!0:y.includes(Re)?!1:y.length===0||!y.includes(E.name.toLowerCase())),T=ze(w,e,s,t.SUMMARY),k=`${S}${p.name}${T} [${p.points}]`;o+=`<div><p style="color:var(--color-text-primary);font-weight:600;font-size:0.875rem;margin-bottom:0.25rem;">${k}</p></div>`,l+=`${c} ${k}
`;return}const b=`${S}${p.name} [${p.points}]`;o+=`<div><p style="color:var(--color-text-primary);font-weight:600;font-size:0.875rem;margin-bottom:0.25rem;">${b}</p>`,l+=`${c} ${b}
`;const g=p.items||[];if(d){let y=Ge(p);y.length>0&&(o+='<div style="padding-left:1rem;font-size:0.75rem;color:var(--color-text-secondary);font-weight:400;">',y.forEach(_=>{const T=(parseInt((_.quantity||"1").toString().replace("x",""),10)||1)>1?`${_.quantity} `:"";o+=`<p style="margin:0;">${T}${_.name}</p>`,l+=`  - ${T}${_.name}
`}),o+="</div>")}else{const _=g.filter(T=>T.type==="wargear"||T.type==="special");_.length>0&&(o+='<div style="padding-left:1rem;font-size:0.75rem;color:var(--color-text-secondary);font-weight:400;">',_.forEach(T=>{const E=(parseInt((T.quantity||"1").toString().replace("x",""),10)||1)>1?`${T.quantity} `:"";let I=T.name;if(T.type==="special"&&(T.name||"").toString().startsWith&&(T.name||"").toString().startsWith("Enhancement:")){const M=T.name.toString().replace(/^Enhancement:\s*/i,"").trim();let D="";if(T.nameshort){const v=(T.nameshort||"").toString().match(/\(([^)]+)\)/);v&&(D=v[1].replace(/\s*pts\s*/i,"").trim(),D=D.startsWith("+")?`(${D})`:`(${D})`)}if(!D){const v=/\(([^)]+)\)/.exec(M);v&&(D=v[1].replace(/\s*pts\s*/i,"").trim(),D=D.startsWith("+")?`(${D})`:`(${D})`)}I=`${M.replace(/\(.*?\)/g,"").trim()}${D?" "+D:""}`}o+=`<p style="margin:0;">${E}${I}</p>`,l+=`  - ${E}${I}
`}),o+="</div>");const w=g.filter(T=>T.type==="subunit"||T.items&&T.items.length>0).sort((T,k)=>{const E=parseInt((T.quantity||"1").toString().replace("x",""),10)||1,I=parseInt((k.quantity||"1").toString().replace("x",""),10)||1;return E-I});w.length>0&&(o+='<div style="padding-left:1rem;font-size:0.75rem;color:var(--color-text-secondary);font-weight:400;">',w.forEach(T=>{const k=parseInt((T.quantity||"1").toString().replace("x",""),10)||1,I=`${k>1?`${k} `:""}${T.name}`,M=Ge(T),D=(T.items||[]).some(B=>B.type==="special");M.length===0&&!D||(o+=`<p style="font-weight:500;color:var(--color-text-primary);margin:0;">${I}</p>`,l+=`  * ${I}
`,M.length>0&&M.forEach(B=>{const W=(parseInt((B.quantity||"1").toString().replace("x",""),10)||1)>1?`${B.quantity} `:"";o+=`<p style="margin:0 0 0.125rem 1rem;">${W}${B.name}</p>`,l+=`    - ${W}${B.name}
`}))}),o+="</div>")}o+="</div>"})}return o+="</div>",{html:o,plainText:l}}function j(t,e,s=!0,u,n,f,m=!1,o){const l=typeof document!="undefined"&&document.querySelector;let a=!1;const r=ce({},{unit:"#FFFFFF",subunit:"#808080",wargear:"#FFFFFF",points:"#FFFF00",header:"#FFFF00"});if(!e){const p=o&&o.colorMode||l&&(document.querySelector('input[name="colorMode"]:checked')||{}).value||"none";if(a=p&&p!=="none",a&&p==="custom"){if(o&&o.colors){const C=o.colors||{};C.unit&&(r.unit=C.unit),C.subunit&&(r.subunit=C.subunit),C.wargear&&(r.wargear=C.wargear),C.points&&(r.points=C.points),C.header&&(r.header=C.header)}else if(l){const C=document.getElementById("unitColor"),S=document.getElementById("subunitColor"),b=document.getElementById("wargearColor"),g=document.getElementById("pointsColor"),y=document.getElementById("headerColor");C&&C.value&&(r.unit=C.value),S&&S.value&&(r.subunit=S.value),b&&b.value&&(r.wargear=b.value),g&&g.value&&(r.points=g.value),y&&y.value&&(r.header=y.value)}}if(a&&p==="faction"){const C=Nt(f||{}),S=t.SUMMARY&&(t.SUMMARY.FACTION_KEYWORD||t.SUMMARY.DISPLAY_FACTION)||null,g=S?(y=>{if(!y)return null;try{return y.toString().normalize("NFD").replace(new RegExp("\\p{M}","gu"),"").replace(/[\u2018\u2019\u201B\u2032]/g,"'").replace(/[^\w\s'\-]/g,"").toLowerCase().trim()}catch(_){return y.toString().toLowerCase()}})(S):null;if(S&&(C[S]||C[S.toString().toLowerCase()]||g&&C[g])){const y=C[S]||C[S.toString().toLowerCase()]||C[g];y.unit&&(r.unit=y.unit),y.subunit&&(r.subunit=y.subunit),y.wargear&&(r.wargear=y.wargear),y.points&&(r.points=y.points),y.header&&(r.header=y.header)}else if(S&&C[S.toString().toLowerCase()]){const y=C[S.toString().toLowerCase()];y.unit&&(r.unit=y.unit),y.subunit&&(r.subunit=y.subunit),y.wargear&&(r.wargear=y.wargear),y.points&&(r.points=y.points),y.header&&(r.header=y.header)}}}const i=(p,C,S=!1)=>{if(!a||!C)return p;const b=typeof document!="undefined"&&document.querySelector,g=!!(o&&o.forcePalette);if(b&&!g){const w=Ke(C);return w?`\x1B[${S?"1;":""}38;2;${w.r};${w.g};${w.b}m${p}\x1B[0m`:p}const y=Tr(C);return`\x1B[${S?"1;":""}${y}m${p}\x1B[0m`},h=e?"•":"*",d=e?"◦":"+";let A="";if(e||(A+=a?"```ansi\n":"```\n"),t.SUMMARY){const p=[];if(t.SUMMARY.LIST_TITLE&&p.push(t.SUMMARY.LIST_TITLE),t.SUMMARY.FACTION_KEYWORD&&p.push(t.SUMMARY.DISPLAY_FACTION||t.SUMMARY.FACTION_KEYWORD.split(" - ").pop()),t.SUMMARY.DETACHMENT&&p.push(t.SUMMARY.DETACHMENT),t.SUMMARY.TOTAL_ARMY_POINTS&&p.push(t.SUMMARY.TOTAL_ARMY_POINTS),p.length){const S=typeof document!="undefined"&&document.querySelector?Sr():!1,b=p.join(S?`
`:" | ");A+=a?i(b,r.header,!0)+`

`:b+`

`}}for(const p in t){if(p==="SUMMARY"||!Array.isArray(t[p]))continue;$t(t[p],n,m).forEach(S=>{const b=parseInt((S.quantity||"1").toString().replace("x",""),10)||1;let g="";if(m&&(S.__groupCount||0)>1){const B=S.__unitSize||b;g=`${S.__groupCount}x${B} `}else g=b>1?`${b} `:"";let y=n?Ge(S):S.items||[];const _=be(f,t.SUMMARY,S.name),w=y.filter(B=>B.type==="special"?!0:_.includes(Re)?!1:_.length===0||!_.includes(B.name.toLowerCase())),T=ze(w,s,u,t.SUMMARY),k=`${g}${S.name}`,E=a?i(k,r.unit,!0):k,I=a&&T?i(T,r.wargear,!1):T,M=`[${S.points}]`,D=a?i(M,r.points,!0):M;if(A+=`${h} ${E}${I} ${D}
`,!n&&Array.isArray(S.items)){const B=S.items.filter(W=>W.type==="subunit"||W.items&&W.items.length>0),v=be(f,t.SUMMARY,S.name);B.forEach(W=>{const H=parseInt((W.quantity||"1").toString().replace("x",""),10)||1,$=`${H>1?`${H} `:""}${W.name}`,q=a?i($,r.subunit,!1):$,z=be(f,t.SUMMARY,W.name),O=z.length===0?v:z,V=(W.items||[]).filter(ae=>ae.type==="special"?!0:O.includes(Re)?!1:O.length===0||!O.includes(ae.name.toLowerCase())),ue=(W.items||[]).some(ae=>ae.type==="special"&&(O.length===0||!O.includes(ae.name.toLowerCase())));if(V.length===0&&!ue)return;const Q=ze(V,s,u,t.SUMMARY),ve=a&&Q?i(Q,r.wargear,!1):Q;A+=`  ${d} ${q}${ve}
`})}})}return e||(A+="```"),A}const wr={Asurmen:!0,Autarch:[],"Autarch Wayleaper":["Shuriken Pistol","Star Glaive"],"Avatar of Khaine":!0,Baharroth:!0,"Corsair Voidreavers":["Shuriken Pistol","Power Sword","Close Combat Weapon"],"Corsair Voidscarred":["Close Combat Weapon"],"Crimson Hunter":["Pulse laser","Wraithbone Hull"],"D-Cannon Platform":!0,"Dark Reapers":["Close Combat Weapon"],"Death Jester":!0,"Dire Avengers":["Close Combat Weapon"],"Eldrad Ulthran":!0,Falcon:["Pulse laser","Wraithbone Hull"],Farseer:["Eldritch Storm","Shuriken Pistol"],"Farseer Skyrunner":["Eldritch Storm","Shuriken Pistol","Twin Shuriken Catapult"],"Fire Dragons":["Close Combat Weapon","Dragon Fusion Gun"],"Fire Prism":["Prism Cannon","Wraithbone Hull"],Fuegan:!0,"Guardian Defenders":["Shuriken Catapult","Close Combat Weapon"],"Hemlock Wraithfighter":!0,"Howling Banshees":["Shuriken Pistol","Banshee Blade"],"Jain Zar":!0,Lhykhis:!0,"Maugan Ra":!0,"Night Spinner":["Doomweaver","Wraithbone Hull"],"Phantom Titan":["Voidstorm Missile Launcher","Phantom Feet"],Rangers:!0,"Revenant Titan":["Cloudburst Missile Launcher","Revenant Feet"],"Shadow Weaver Platform":!0,Shadowseer:["Shuriken Pistol","Miststave","Flip Belt"],"Shining Spears":[],"Shroud Runners":!0,Skyweavers:["Close Combat Weapon","Skyweaver","Invulnerable Save","Acrobatic Grace"],Solitaire:!0,Spiritseer:!0,Starweaver:!0,"Storm Guardians":["Shuriken Pistol","Close Combat Weapon","Serpent Shield"],"Striking Scorpions":[],"Swooping Hawks":["Close Combat Weapon"],"The Visarch":!0,"The Yncarne":!0,Troupe:["Flip Belt"],"Troupe Master":["Shuriken Pistol","Troupe Master's Blade","Flip Belt"],"Vibro Cannon Platform":!0,Voidweaver:["Shuriken Cannon","Close Combat Weapon"],Vypers:["Wraithbone Hull"],"War Walkers":["War Walker Feet"],Warlock:["Destructor","Shuriken Pistol"],"Warlock Conclave":["Destructor","Shuriken Pistol","Warlock"],"Warlock Skyrunners":["Destructor","Shuriken Pistol","Twin Shuriken Catapult"],"Warp Spiders":["Close Combat Weapon"],"Wave Serpent":["Wraithbone Hull"],Windriders:["Close Combat Weapon"],Wraithblades:["Ghostswords","Wraithblade"],Wraithguard:["Close Combat Weapon"],Wraithknight:["Titanic Feet"],"Wraithknight with Ghostglaive":["Titanic Ghostglaive"],Wraithlord:["Wraithbone Fists","Aeldari Missile Launcher"],"Ynnari Archon":["Huskblade","Shadow Field"],"Ynnari Incubi":["Klaive"],"Ynnari Kabalite Warriors":["Splinter Rifle","Close Combat Weapon"],"Ynnari Raider":["Bladevanes"],"Ynnari Reavers":["Splinter Pistol","Bladevanes"],"Ynnari Succubus":["Succubus Weapons"],"Ynnari Venom":["Bladevanes"],"Ynnari Wyches":["Splinter Pistol","Hekatarii Blade"],Yvraine:!0},kr={"Corvus Blackstar":["Armoured Hull"],"Deathwatch Terminator Squad":[],"Deathwatch Veterans":[],"Fortis Kill Team":[],"Indomitor Kill Team":[],"Spectrus Kill Team":[],"Talonstrike Kill Team":[],"Watch Captain Artemis":!0,"Watch Master":!0},Rr={Archon:["Huskblade"],Beastmaster:!0,"Court of the Archon":!0,Cronos:["Spirit Syphon","Spirit-Leech Tentacles"],Drazhar:!0,Grotesques:["Monstrous Weapons"],Haemonculus:!0,Hellions:["Splinter Pods","Hellglaive"],Incubi:["Klaive"],"Kabalite Warriors":["Splinter Rifle","Close Combat Weapon"],"Lelith Hesperax":!0,Mandrakes:!0,Raider:["Bladevanes"],Ravager:["Bladevanes"],"Razorwing Jetfighter":["Razorwing Missiles","Bladed Wings"],Reavers:["Splinter Pistol","Bladevanes"],Scourges:["Close Combat Weapon"],Succubus:["Succubus Weapons"],Talos:[],"Urien Rakarth":!0,Venom:["Bladevanes"],"Voidraven Bomber":["Bladed Wings"],Wracks:["Wrack Blades"],Wyches:["Splinter Pistol","Hekatarii Blade"]},Er={"Annihilation Barge":["Twin Tesla Destructor","Armoured Bulk"],"C'tan Shard of the Deceiver":!0,"C'tan Shard of the Nightbringer":!0,"C'tan Shard of the Void Dragon":!0,"Canoptek Doomstalker":!0,"Canoptek Reanimator":!0,"Canoptek Scarab Swarms":!0,"Canoptek Spyders":["Automaton Claws"],"Canoptek Wraiths":[],"Catacomb Command Barge":[],Chronomancer:!0,"Convergence of Dominion":!0,Cryptothralls:!0,Deathmarks:!0,"Doom Scythe":!0,"Doomsday Ark":!0,"Flayed Ones":!0,"Ghost Ark":!0,"Hexmark Destroyer":!0,"Illuminor Szeras":!0,Immortals:["Close Combat Weapon"],"Imotekh the Stormlord":!0,"Lokhust Destroyers":!0,"Lokhust Heavy Destroyers":["Close Combat Weapon"],"Lokhust Lord":["Nanoscarab Amulet"],Lychguard:[],Monolith:["Particle Whip","Portal of Exile"],"Necron Warriors":["Close Combat Weapon"],"Night Scythe":!0,Obelisk:!0,"Ophydian Destroyers":["Ophydian Hyperphase Weapons"],"Orikan the Diviner":!0,Overlord:[],"Overlord with Translocation Shroud":!0,Plasmancer:!0,Psychomancer:!0,"Royal Warden":!0,"Seraptek Heavy Construct":["Titanic Forelimbs"],"Skorpekh Destroyers":["Skorpekh Hyperphase Weapons"],"Skorpekh Lord":!0,Technomancer:!0,"Tesseract Vault":!0,"The Silent king":!0,"Tomb Blades":["Close Combat Weapon"],"Transcendent C'tan":!0,"Trazyn the Infinite":!0,"Triarch Praetorians":[],"Triarch Stalker":["Stalker's Forelimbs"]},Mr={Battlewagon:[],"Beast Snagga Boyz":[],Beastboss:!0,"Beastboss on Squigosaur":["Slugga","Beastchoppa","Squigosaur's Jaws"],"Big Mek":[],"Big Mek in Mega Armour":[],"Big Mek with Shokk Attack Gun":["Close Combat Weapon","Shokk Attack Gun"],"Big'ed Bossbunka":["Gaze of Gork"],"Blitza-Bommer":!0,"Boomdakka Snazzwagon":!0,"Boss Snikrot":!0,Boyz:[],"Breaka Boyz":[],"Burna Boyz":["Burna","Cuttin' Flames","Close Combat Weapon"],"Burna-Bommer":["Twin Big Shoota","Twin Supa-Shoota","Armoured Hull"],Dakkajet:["Armoured Hull"],"Deff Dread":["Stompy Feet"],"Deffkilla Wartrike":!0,Deffkoptas:["Slugga","Spinnin' Blades"],"Flash Gitz":["Snazzgun","Choppa"],"Gargantuan Squiggoth":["Huge Tusks"],"Ghazghkull Thraka":!0,Gorkanaut:!0,Gretchin:!0,"Hunta Rig":!0,"Kill Rig":!0,"Killa Kans":["Kan Klaw"],Kommandos:[],"Kustom Boosta-Blasta":!0,Lootas:["Close Combat Weapon","Deffgun"],"Mozrog Skragbad":!0,Meganobz:[],"Megatrakk Scrapjet":!0,Mek:["Kustom-Mega Slugga"],"Mek Gunz":["Grot Crew"],Morkanaut:!0,Nobz:[],Painboss:["Beast Snagga klaw"],Painboy:["Power Klaw","urty Syringe"],"Rukkatrukk Squigbuggy":!0,"Shokkjump Dragsta":!0,"Squighog Boyz":["Slugga","Big Choppa","Squig Jaws","Saddlegit Weapons","Stikka"],Stompa:!0,Stormboyz:["Slugga"],Tankbustas:["Choppa","Close Combat Weapon"],Trukk:["Big Shoota","Spiked Wheels"],Warbikers:["Twin Dakkagun","Close Combat Weapon"],Warboss:["Kombi-weapon","Twin Slugga"],"Warboss in Mega Armour":!0,"Wazbom Blastajet":["Smasha Gun","Armoured Hull"],Weirdboy:!0,Wurrboy:!0,"Zodgrod Wortsnagga":!0},xr={"Adrax Agatone":!0,"Vulkan He'stan":!0},Ir={Barbgaunts:!0,Biovores:!0,Broodlord:!0,Carnifexes:["Chitinous Claws and Teeth"],Deathleaper:!0,Exocrine:!0,Gargoyles:!0,Genestealers:!0,Harpy:["Stinger Salvoes","Scything Wings"],Harridan:!0,Haruspex:!0,Hierophant:!0,"Hive Crone":!0,"Hive Guard":["Chitinous Claws and Teeth"],"Hive Tyrant":[],Hormagaunts:!0,"Hyperadapted Raveners":!0,Lictor:!0,Maleceptor:!0,Mawloc:!0,"Mucolid Spores":!0,Neurogaunts:!0,Neurolictor:!0,Neurotyrant:!0,"Norn Assimilator":!0,"Norn Emissary":!0,"Old One Eye":!0,"Parasite of Mortrex":!0,Psychophage:!0,Pyrovores:!0,Raveners:!0,"Ripper Swarms":!0,"Screamer-Killer":!0,"Spore Mines":!0,Sporocyst:!0,Termagants:["Chitinous Claws and Teeth","Mucolid Spores (30 pts):"],Tervigon:["Stinger Salvoes"],"The Swarmlord":!0,Toxicrene:!0,Trygon:!0,"Tyranid Warriors with Melee Bio-Weapons":!0,"Tyranid Warriors with Ranged Bio-weapons":["Tyranid Warrior claws and talons"],Tyrannocyte:!0,Tyrannofex:["Stinger Salvoes","Powerful Limbs"],"Tyrant Guard":[],Venomthropes:!0,"Von Ryan's Leapers":!0,"Winged Hive Tyrant":["Tyrant talons"],"Winged Tyranid Prime":!0,Zoanthropes:["Warp blast"]},vr={"Captain Sicarius":!0,"Chief Librarian Tigurius":!0,"Lieutenant Titus":!0,"Marneus Calgar":!0,"Roboute Guilliman":!0,"Uriel Ventris":!0},U={"World Eaters":{Angron:!0,Bloodcrushers:["Hellblade","Bladed Horn"],Bloodletters:["Hellblade"],Bloodthirster:["Hellfire Breath"],"Chaos Land Raider":["Soulshatter Lascannon","Armoured Tracks","Twin Heavy Bolter"],"Chaos Predator Annihilator":["Predator Twin Lascannon","Armoured Tracks"],"Chaos Predator Destructor":["Predator Autocannon","Armoured Tracks"],"Chaos Rhino":["Armoured Tracks"],"Chaos Spawn":!0,"Daemon Prince":!0,"Daemon Prince of Khorne":!0,"Daemon Prince of Khorne with Wings":!0,Defiler:["Defiler Cannon","Defiler Claws"],Eightbound:!0,"Exalted Eightbound":!0,"Flesh Hounds":!0,Goremongers:["Chainblade","Close Combat Weapon"],Heldrake:["Heldrake Claws"],Jakhals:["Autopistol","Chainblades","Jakhal Chainblades"],"Khorne Berserkers":["Bolt Pistol","Khorne Berserker","Chainblade","Berserker Chainblade"],"Khorne Berzerkers":["Bolt Pistol","Khorne Berzerker","Chainblade","Berzerker Chainblade"],"Khorne Lord of Skulls":["Great Cleaver of Khorne"],"Khârn The Betrayer":!0,"Lord Invocatus":!0,"Lord on Juggernaut":!0,"Master of Executions":!0,Maulerfiend:["Maulerfiend fists"],Skarbrand:!0,Slaughterbound:!0},"Adepta Sororitas":{"Aestred Thurga and Agathae Dolan":!0,"Arco-Flagellants":!0,"Battle Sisters Squad":["Bolt Pistol","Close Combat Weapon"],Canoness:[],"Canoness with Jump Pack":[],Castigator:["Heavy Bolter","Armoured Tracks"],"Celestian Sacresants":[],Daemonifuge:!0,Dialogus:!0,Dogmata:!0,"Dominion Squad":["Bolt Pistol","Boltgun","Close Combat Weapon"],Exorcist:["Heavy Bolter","Armoured Tracks"],Hospitaller:!0,Imagifier:!0,Immolator:["Heavy Bolter","Armoured Tracks"],"Junith Eruita":!0,"Ministorum Priest":[],Mortifiers:[],"Morvenn Vahl":!0,Palatine:["Palatine Blade"],"Paragon Warsuits":["Bolt Pistol"],"Penitent Engines":["Penitent Flamers"],"Repentia Squad":!0,"Retributor Squad":["Bolt Pistol","Close Combat Weapon"],"Saint Celestine":!0,Sanctifiers:[],"Seraphim Squad":["Close Combat Weapon","Seraphim"],"Sisters Novitiate Squad":["Close Combat Weapon","Sister Novitiate"],"Sororitas Rhino":["Storm Bolter","Armoured Tracks"],"Triumph of Saint Katherine":!0,"Zephyrim Squad":["Power Weapon"]},"Adeptus Custodes":{"Agamatus Custodians":["Interceptor Lance"],Aleya:!0,"Allarus Custodians":["Balistus Grenade Launcher"],"Anathema Psykana Rhino":["Storm Bolter","Armoured Tracks"],"Aquilon Custodians":[],"Ares Gunship":!0,"Blade Champion":!0,"Caladius Grav-tank":["Twin Lastrum Bolt Cannon","Armoured Hull"],"Contemptor-Achillus Dreadnought":["Achillus Dreadspear"],"Contemptor-Galatus Dreadnought":!0,"Coronus Grav-carrier":!0,"Custodian Guard":[],"Custodian Guard with Adrasite and Pyrithite Spears":[],"Custodian Wardens":[],"Knight-Centura":[],"Orion Assault Dropship":!0,"Pallas Grav-attack":!0,Prosecutors:!0,"Sagittarum Custodians":!0,"Shield-Captain":[],"Shield-captain In Allarus Terminator Armour":["Balistus Grenade Launcher"],"Shield-captain on Dawneagle Jetbike":["Interceptor Lance"],"Telemon Heavy Dreadnought":["Spiculus Bolt Launcher","Armoured Feet"],"Trajann Valoris":!0,Valerian:!0,"Venatari Custodians":[],"Venerable Contemptor Dreadnought":["Combi-Bolter","Contemptor Combat Weapon"],"Venerable Land Raider":["Godhammer Lascannon","Twin Heavy Bolter","Armoured Tracks"],"Vertus Praetors":["Interceptor Lance"],Vigilators:!0,Witchseekers:!0},"Adeptus Mechanicus":{"Archaeopter Fusilave":["Cognis Heavy Stubber Array","Armoured Hull"],"Archaeopter Stratoraptor":["Cognis Heavy Stubber","Heavy phosphor blaster","Twin Cognis Lascannon","Armoured Hull"],"Archaeopter Transvector":["Cognis Heavy Stubber Array","Armoured Hull"],"Belisarius Cawl":!0,"Corpuscarii Electro-priests":!0,"Cybernetica Datasmith":!0,"Fulgurite Electro-priests":!0,"Ironstrider Ballistarii":["Ironstrider Feet"],"Kastelan Robots":[],"Kataphron Breachers":[],"Kataphron Destroyers":["Close Combat Weapon"],"Onager Dunecrawler":["Dunecrawler Legs"],"Pteraxii Skystalkers":!0,"Pteraxii Sterylizors":!0,"Serberys Raiders":["Mechanicus Pistol","Galvanic Carbine","Cavalry sabre & clawed limbs"],"Serberys Sulphurhounds":["Mechanicus Pistol","Sulphur Breath","Cavalry Arc Maul","Clawed Limbs"],"Servitor Battleclade":["Heavy Arc Rifle","Heavy Bolter","Mechanicus Pistol","Dataspikes","Servo-claw"],"Sicarian Infiltrators":["Stubcarbine","Power Weapon"],"Sicarian Ruststalkers":[],"Skitarii Marshal":!0,"Skitarii Rangers":["Galvanic Rifle","Close Combat Weapon"],"Skitarii Vanguard":["Radium Carbine","Close Combat Weapon"],"Skorpius Disintegrator":["Cognis Heavy Stubber","Disruptor Missile Launcher","Armoured Hull"],"Skorpius Dunerider":!0,"Sydonian Dragoons with Radium Jezzails":!0,"Sydonian Skatros":["Mechanicus Pistol","Sydonian Feet"],"Tech-Priest Dominus":["Omnissian Axe"],"Tech-Priest Enginseer":!0,"Tech-Priest Manipulus":["Omnissian Staff"],Technoarcheologist:!0,"sydonian Dragoons with Taser Lances":!0},"Adeptus Titanicus":{"Reaver Titan":["Reaver apocalypse launcher","reaver feet"],"Warbringer Nemesis Titan":["Anvillus Defence Battery","Ardex-defensor Mauler","Nemesis Feet"],"Warhound Titan":["Warhound Feet"],"Warlord Titan":["Ardex-defensor Mauler","Ardex-defensor Lascannon","Warlord Feet"]},Aeldari:wr,"Astra Militarum":{"Aegis Defence Line":!0,"Armoured Sentinels":["Close Combat Weapon","armoured sentinel"],"Artillery Team":["Lasgun","Crew Close Combat Weapons"],"Attilan Rough Riders":["Hunting Lance","Steed's hooves"],"Avenger Strike Fighter":!0,Baneblade:["Baneblade Cannon","Coaxial Autocannon","Demolisher Cannon","Armoured Tracks"],Banehammer:["Tremor Cannon","Armoured Tracks"],Banesword:["Quake Cannon","Armoured Tracks"],Basilisk:["Earthshaker Cannon","Armoured Tracks"],"Bullgryn Squad":["Grenadier Gauntlet","Close Combat Weapon","Slabshield"],"Cadian Command Squad":["Medi-pack","Regimental Standard","Master Vox"],"Cadian Heavy Weapons Squad":["Weapons Team Close Combat Weapons","Heavy Weapons Team"],"Cadian Shock Troops":["Lasgun","Laspistol","Close Combat Weapon","Shock Trooper"],"Catachan Command Squad":[],"Catachan Heavy Weapons Squad":["Weapons Team Close Combat Weapons"],"Catachan Jungle Fighters":["Laspistol","Close Combat Weapon","lasgun","Catachan Jungle Fighter"],Chimera:["Armoured Tracks"],"Cyclops Demolition Vehicle":!0,"Death Korps of Krieg":["Laspistol","Chainsword","Lasgun","Close Combat Weapon"],"Death Riders":!0,Deathstrike:["Deathstrike Missile","Armoured Tracks"],Doomhammer:["Magma Cannon","Armoured Tracks"],"Field Ordnance Battery":["Battery Close Combat Weapons"],"Gaunt's Ghosts":!0,Hellhammer:["Coaxial Autocannon","Demolisher Cannon","Hellhammer Cannon","Armoured Tracks"],Hellhound:["Armoured Tracks"],Hydra:["Hydra Autocannon","Armoured Tracks"],Kasrkin:["Hot-Shot Laspistol","Chainsword","Hot-Shot Lasgun","Close Combat Weapon"],"Krieg Combat Engineers":["Autopistol","Trench Club"],"Krieg Command Squad":["Alchemyk Counteragents","Servo-Scribes","Master Vox","Regimental Standard"],"Krieg Heavy Weapons Squad":["Laspistol","Heavy Weapons Gunner","Close Combat Weapon"],"Leman Russ Battle Tank":["Leman Russ Battle Cannon","Armoured Tracks"],"Leman Russ Commander":["Armoured Tracks"],"Leman Russ Demolisher":["Demolisher Battle Cannon","Armoured Tracks"],"Leman Russ Eradicator":["Eradicator Nova Cannon","Armoured Tracks"],"Leman Russ Executioner":["Executioner Plasma Cannon","Armoured Tracks"],"Leman Russ Exterminator":["Exterminator Autocannon","Armoured Tracks"],"Leman Russ Punisher":["Punisher Gatling Cannon","Armoured Tracks"],"Leman Russ Vanquisher":["Vanquisher Battle Cannon","Armoured Tracks"],"Lord Marshal Dreir":!0,"Lord Solar Leontus":!0,Manticore:["Storm Eagle Rockets","Armoured Tracks"],"Militarum Tempestus Command squad":["Hot-Shot Lasgun","Tempestus Dagger"],"Ministorum Priest":[],"Nork Deddog":!0,"Ogryn Bodyguard":[],"Ogryn Squad":!0,"Primaris Psyker":!0,Ratlings:["Sniper Rifle","Close Combat Weapon"],"Rogal Dorn Battle Tank":["Armoured Tracks"],"Rogal Dorn Commander":["Armoured Tracks"],"Scout Sentinels":["Scout Sentinel"],Shadowsword:["Volcano Cannon","Armoured Tracks"],"Sly Marbo":!0,StormSword:["Stormsword Siege Cannon","Armoured Tracks"],Stormlord:["Vulcan Mega-bolter","Armoured Tracks"],Taurox:["Twin Autocannon","Armoured Tracks"],"Taurox Prime":["Armoured Tracks"],"Tech-Priest Enginseer":!0,"Tempestus Aquilons":["Close Combat Weapon"],"Tempestus Scions":["Close Combat Weapon","Chainsword"],"Ursula Creed":!0,Valkyrie:["Armoured Hull"],Wyvern:["Wyvern Quad Stormshard Mortar","Armoured Tracks"]},"Black Templars":{"Black Templars Gladiator Lancer":["Lancer Laser Destroyer","Armoured Hull"],"Black Templars Gladiator Reaper":["Tempest Bolter","Twin Heavy Onslaught Gatling Cannon","Armoured Hull"],"Black Templars Gladiator Valiant":["Twin Las-Talon","Armored Hull"],"Black Templars Impulsor":["Armoured Hull"],"Black Templars Repulsor":["Heavy Onslaught Gatling Cannon","Hunter-Slayer Missile","Repulsor Defensive Array","Armoured Hull"],"Black Templars Repulsor Executioner":["Heavy Onslaught Gatling Cannon","Repulsor Executioner Defensive Array","Twin Heavy Bolter","Twin Icarus Ironhail Heavy Stubber","Armoured Hull"],Castellan:[],"Chaplain Grimaldus":!0,"Crusader Squad":[],"High Marshal Helbrecht":!0,Marshal:["Master-Crafted Power Weapon"],"Primaris Crusader Squad":[],"Primaris Sword Bretheren":[],"The Emperor's Champion":!0},"Blood Angels":{Astorath:!0,"Baal Predator":["Armoured Tracks"],"Blood Angels Captain":[],"Chief Librarian Mephiston":!0,"Commander Dante":!0,"Death Company Captain":[],"Death Company Captain with Jump Pack":[],"Death Company Dreadnought":["Twin Icarus Ironhail Heavy Stubber"],"Death Company Marines":[],"Death Company Marines with Bolt Rifles":[],"Death Company Marines with Jump Packs":[],Lemartes:!0,"Sanguinary Guard":[],"Sanguinary Priest":!0,"The Sanguinor":!0},"Chaos Daemons":{"Be'Lakor":["Betraying Shades","The Blade of Shadows"],"Beasts of Nurgle":["Putrid Appendages"],Bloodcrushers:["Hellblade","Juggernaut's Bladed Horn"],Bloodletters:["Hellblade"],Bloodthirster:["Hellfire Breath"],"Blue Horrors":["Coruscating Blue Flames","Blue Claws","Coruscating Yellow Flames","Yellow Claws"],"Burning Chariot":["Fire of Tzeentch","Flamer Mouths","Screamer Bites"],Changecaster:["Arcane Fireball","Herald Combat Weapon"],"Contorted Epitome":["Coiled Tentacles","Ravaging Claws"],"Daemon Prince of Chaos":["Hellforged Weapons","Infernal Cannon"],"Daemon Prince of Chaos With Wings":["Hellforged Weapons","Infernal Cannon"],Daemonettes:["Slashing Claws"],Epidemius:["Balesword and Nurgling Attendants"],"Exalted Flamer":["Fire of Tzeentch","Flamer Mouths"],Fateskimmer:["Arcane Fireball","Herald Combat Weapon","Screamer Bites"],Fiends:["Barbed Tail and Dissecting Claws"],Flamers:["Flickering Flames","Flamer Mouths"],"Flesh Hounds":["Burning Roar","Gore-drenched Fangs","Collar of Khorne"],Fluxmaster:["Arcane Fireball","Herald Combat Weapon"],"Great Unclean One":["Putrid Vomit"],Hellflayers:["Lashes of Torment","Seeker Tongues","Slashing Claws"],"Horticulous Slimux":["Acidic Maw","Lopping Shears"],"Infernal Enrapturess":["Heartstring Lyre","Ravaging Claws"],"Kairos Fateweaver":["Infernal Gateway","Staff of Tomorrow"],Karanak:["Scalding Roar","Soul-Rending Fangs","Brass Collar of Bloody Vengeance"],"Keeper of Secrets":["Phantasmagoria","Snapping Claws","Witstealer Sword"],"Lord of Change":["Bolt of Change","Staff of Tzeentch"],Nurglings:["Diseased Claws and Teeth"],"Pink Horrors":["Coruscating Blue Flames","Coruscating Yellow Flames","Coruscating Pink Flames","Pink Claws","Blue Claws","Yellow Claws"],"Plague Drones":["Death's Heads","Foul Mouthparts","Plaguesword"],Plaguebearers:["Plaguesword"],Poxbringer:["Foul Balesword"],"Rendmaster on Blood Throne":["Attendants' Hellblades","Blade of Blood"],Rotigus:["Streams of Brackish Filth","Gnarlrod"],Screamers:["Lamprey Bite"],Seekers:["Lashing Tongue","Slashing Claws"],"Shalaxi Helbane":["Lash of Slaanesh","Pavane of Slaanesh","Snapping Claws","Soulpiercer"],Skarbrand:["Bellow of Endless Fury","Slaughter and Carnage"],"Skull Cannon":["Skull Cannon","Attendants' Hellblades","Biting Maw"],Skullmaster:["Blade of Blood","Juggernaut's Bladed Horn"],Skulltaker:["The Slayer Sword"],"Sloppity Bilepiper":["Marotter"],"Soul Grinder":["Harvester Cannon","Iron Claw"],"Spoilpox Scrivener":["Disgusting Sneezes","Plaguesword and Distended Maw"],"Syll'esske":["Cacophonic Choir","Scourging Whip","Axe of Dominion"],"The Blue Scribes":["Sharp Quills"],"The Changeling":["Infernal Flames","The Trickster's Staff"],"The masque of Slaanesh":["Serrated Claws"],Tormentbringer:["Lashes of Torment","Seeker Tongues","Slashing Claws"],Tranceweaver:["Ravaging Claws"]},"Chaos Knights":{"Chaos Acastus Knight Asterius":["Asterius Volkite Culverin","Karacnos mortar Battery","twin conversion beam cannon","Titanic Feet"],"Chaos Acastus Knight Porphyrion":["Twin Magna Lascannon","Titanic Feet"],"Chaos Cerastus Knight Acheron":["Acheron Flame Cannon","Twin Heavy Bolter","Reaper Chainfist"],"Chaos Cerastus Knight Atrapos":["Atrapos Lascutter","Graviton Singularity Cannon"],"Chaos Cerastus Knight Castigator":["Castigator Bolt Cannon","Tempest Warblade"],"Chaos Cerastus Knight Lancer":["Cerastus Shock Lance"],"Chaos Questoris Knight Magaera":["Lightning cannon","Phased Plasma-fusil"],"Chaos Questoris Knight Styrix":["Graviton Crusher","Volkite Chierovile"],"Knight Abominant":["Diabolus Heavy Stubber","Volkite Combustor","Balemace","Electroscourge"],"Knight Desecrator":["Desecrator Laser Destroyer","Diabolus Heavy Stubber"],"Knight Despoiler":["Titanic Feet"],"Knight Rampager":["Diabolus Heavy Stubber","Reaper Chainsword","Warpstrike Claw"],"Knight Ruinator":["Darkflame Lance","Terrorpulse Missiles","Fellbore"],"Knight Tyrant":["Titanic Feet"],"War Dog Brigand":["Avenger Chaincannon","Daemonbreath Spear","Armoured Feet"],"War Dog Executioner":["War Dog Autocannon","Armoured Feet"],"War Dog Huntsman":["Reaper Chaintalon","Daemonbreath Spear"],"War Dog Karnivore":["Reaper Chaintalon","Slaughterclaw"],"War Dog Moirax":["Armoured Feet"],"War Dog Stalker":[]},"Chaos Space Marines":{"Abbadon the Despoiler":!0,"Accursed Cultists":!0,"Chaos Bikers":[],"Chaos Land Raider":["Soulshatter Lascannon","Twin Heavy Bolter","Armoured Tracks"],"Chaos Lord":[],"Chaos Lord in Terminator Armour":[],"Chaos Lord with Jump Pack":[],"Chaos Predator Annihilator":["Predator Twin Lascannon","Armoured Tracks"],"Chaos Predator Destructor":["Predator Autocannon","Armoured Tracks"],"Chaos Rhino":["Armoured Tracks"],"Chaos Spawn":!0,"Chaos Terminator Squad":[],"Chaos Vindicator":["Demolisher Cannon","Armoured Tracks"],Chosen:[],"Cultist Firebrand":!0,"Cultist Mob":["Brutal Assault Weapon"],Cypher:!0,"Dark Apostle":!0,"Dark Commune":!0,Defiler:["Defiler Cannon","Defiler Claws"],"Fabius Bile":!0,"Fellgor Beastmen":["Chainsword","Autopistol"],Forgefiend:[],"Haarken Worldclaimer":!0,Havocs:["Flamer"],Helbrute:[],Heldrake:["Heldrake Claws"],"Heretic Astartes Daemon Prince":!0,"Heretic Astartes Daemon Prince With Wings":!0,"Huron Blackheart":!0,"Khorne Berzerkers":[],"Khorne Lord of Skulls":["Great Cleaver of Khorne"],Legionaries:[],"Lord Discordant on Helstalker":["bladed limbs","impaler chainglaive"],"Master of Executions":!0,"Master of Posession":!0,Maulerfiend:["Maulerfiend Fists"],"Nemesis Claw":[],"Noctilith Crown":!0,"Noise Marines":[],Obliterators:!0,"Plague Marines":[],Possessed:["Hideous Mutations"],Raptors:[],"Rubric Marines":[],Sorcerer:!0,"Sorcerer in Terminator Armour":["Infernal Gaze","Force Weapon"],"Traitor Enforcer":!0,"Traitor Guardsmen Squad":[],"Vashtorr the Arkifane":!0,Venomcrawler:!0,"Warp Talons":!0,Warpsmith:!0},"Dark Angels":{Asmodai:!0,Azrael:!0,Belial:!0,"Deathwing Knights":[],"Deathwing Terminator Squad":["Storm Bolter","Power Weapon"],Ezekiel:!0,"Inner Circle Companions":!0,"Land Speeder Vengeance":["Plasma Storm Battery","Close Combat Weapon"],Lazarus:!0,"Lion El'Jonson":!0,"Nephilim Jetfighter":["Blacksword Missiles","Twin Heavy Bolter","Armoured Hull"],"Ravenwind Darkshroud":["Close Combat Weapon"],"Ravenwing Black Knights":["Bolt Pistol","Black Knight Combat Weapon"],"Ravenwing Command Squad":["Bolt Pistol","Black Knight Combat Weapon","Master-Crafted Power Weapon"],"Ravenwing Dark Talon":!0,Sammael:!0},"Death Guard":{"Beasts of Nurgle":!0,"Biologus Putrifier":!0,"Blightlord Terminators":["Bubotic Blade"],"Chaos Land Raider":["Soulshatter Lascannon","Twin Heavy Bolter","Armoured Tracks"],"Chaos Predator Annihilator":["Predator Twin Lascannon","Armoured Tracks"],"Chaos Predator Destructor":["Predator Autocannon","Armoured Tracks"],"Chaos Rhino":["Armoured Tracks"],"Chaos Spawn":!0,"Daemon Prince of Nurgle":!0,"Daemon Prince of Nurgle With Wings":!0,"Deathshroud Terminators":["Plaguespurt Gauntlet","Manreaper"],Defiler:["Defiler Cannon","Defiler Claws"],"Foetid Bloat Drone":["Plague Probe"],"Foetid Bloat Drone with Heavy Blight Launcher":!0,"Great Unclean One":["Putrid Vomit"],Helbrute:[],"Icon Bearer":!0,"Lord of Contagion":!0,"Lord of Poxes":!0,"Lord of Virulence":!0,"Malignant Plaguecaster":!0,"Miasmic Malignifier":!0,Mortarion:!0,"Myphitic Blight-Haulers":!0,"Noxious Blightbringer":!0,Nurglings:!0,"Plague Drones":["Death's Heads","Foul Mouthparts","Plaguesword"],"Plague Marines":[],"Plague Surgeon":!0,Plaguebearers:["Plaguesword"],"Plagueburst Crawler":["Plagueburst Mortar","Armoured Tracks"],Poxwalkers:!0,Rotigus:!0,Tallyman:!0,Typhus:!0},Deathwatch:kr,Drukhari:Rr,"Emperor's Children":{"Chaos Land Raider":["Soulshatter Lascannon","Twin Heavy Bolter","Armoured Tracks"],"Chaos Rhino":["Armoured Tracks"],"Chaos Spawn":!0,"Chaos Terminators":[],"Daemon Prince of Slaanesh":!0,"Daemon Prince of Slaanesh with Wings":!0,Daemonettes:["Slashing Claws"],Fiends:!0,"Flawless Blades":!0,Fulgrim:!0,Heldrake:["Heldrake Claws"],Infractors:["Duelling Sabre"],"Keeper of Secrets":["Phantasmagoria","Snapping Claws","Witstealer Sword"],"Lord Exultant":[],"Lucius the Eternal":!0,Maulerfiend:["Maulerfiend Fists"],"Noise Marines":[],Seekers:["Lashing Tongue","Slashing Claws"],"Shalaxi Helbane":!0,Sorcerer:!0,Tormentors:[]},"Genestealer Cults":{Aberrants:!0,Abominant:!0,"Achilles Ridgerunners":["Armoured Hull"],"Acolyte Hybrids with Autopistols":[],"Acolyte Hybrids with Hand Flamers":[],"Acolyte Iconward":!0,"Atalan Jackals":["Atalan Small Arms","Close Combat Weapon"],Benefictus:!0,Biophagus:!0,Clamavus:!0,"Goliath Rockgrinder":["Heavy Stubber","Drilldozer blade","Demolition Charge Cache"],"Goliath Truck":!0,"Hybrid Metamorphs":["Autopistol","Leader's Bio-weapons","Metamorph Mutations"],"Jackal Alphus":!0,Kelermorph:!0,Locus:!0,Magus:!0,"Neophyte Hybrids":["Autopistol","Hybrid Firearm","Close Combat Weapon"],Nexos:!0,Patriarch:!0,Primus:!0,"Purestrain Genestealers":!0,"Reductus Saboteur":!0,Sanctus:[]},"Grey Knights":{"Brother-Captain Stern":!0,"Brotherhood Champion":!0,"Brotherhood Chaplain":!0,"Brotherhood Librarian":["Purge Soul","Vortex of Doom"],"Brotherhood Techmarine":["Plasma Cutter","Omnissian Power Axe","Servo-Arms","Forge Bolter","Grav-Pistol","Flamer"],"Brotherhood Terminator Squad":[],"Castellan Crowe":!0,"Grand Master Voldus":!0,"Grand Master in Nemesis Dreadknight":["Fragstorm Grenade Launcher"],"Land Raider":["Godhammer Lascannon","Twin Heavy Bolter","Armoured Tracks"],"Land Raider Crusader":["Hurricane Bolter","Twin Assault Cannon","Armoured Tracks"],"Land Raider Redeemer":["Flamestorm Cannon","Twin Assault Cannon","Armoured Tracks"],Razorback:["Armoured Tracks"],Rhino:["Armoured Tracks"],"Stormhawk Interceptor":["Armoured Hull"],"Stormraven Gunship":["Stormstrike Missile Launcher","Armoured Hull"],"Stormtalon Gunship":["Twin Assault Cannon","Armoured Hull"],"Grey Knights Thunderhawk Gunship":["Lascannon","Twin Heavy Bolter","Armoured Hull"],"Venerable Dreadnought":[],"Interceptor Squad":["Close Combat Weapon"],"Kaldor Draigo":!0,"Land Raider Banisher":["Armoured Tracks"],"Nemesis Dreadknight":[],"Paladin Squad":[],"Purgation Squad":["Close Combat Weapon"],"Purifier squad":["Purifying Flame","Close Combat Weapon"],Servitors:["Servitor's Servo-arm","Servitor's Tools"],"Strike Squad":["Close Combat Weapon"]},"Imperial Fists":{"Darnath Lysander":!0,"Pedro Kantor":!0,"Tor Garadon":!0},"Imperial Knights":{"Acastus Knight Asterius":!0,"Acastus Knight Porphyrion":["Twin Magna Lascannon","Titanic Feet"],"Armiger Helverin":["Armiger Autocannon","Armoured Feet"],"Armiger Moirax":["Armoured Feet"],"Armiger Warglaive":["Reaper Chain-cleaver","Thermal Spear","Armoured Feet"],"Canis Rex":!0,"Cerastus Knight Atrapos":!0,"Cerastus Knight Acheron":!0,"Cerastus Knight Castigator":!0,"Cerastus Knight Lancer":!0,"Knight Castellan":["Plasma Decimator","Twin Meltagun","Volcano Lance","Titanic Feet"],"Knight Crusader":["Avenger Gatling Cannon","Titanic Feet"],"Knight Errant":["Thermal Cannon"],"Knight Gallant":["Thunderstrike Gauntlet","Reaper Chainsword"],"Knight Paladin":["Rapid-Fire Battle Cannon"],"Knight Preceptor":["Las-Impulsor"],"Knight Valiant":["Conflagration Cannon","Thundercoil Harpoon","Twin Meltagun","Titanic Feet"],"Knight Warden":["Avenger Gatling Cannon","Heavy Flamer"],"Questoris Knight Magaera":["Lightning Cannon","Phased Plasma-fusil"],"Questoris Knight Styrix":["Graviton Crusher","Volkite Chierovile"],"Sir Hekhtur":!0},"Iron Hands":{"Iron Father Feirros":!0},"Leagues of Votann":{"Buri Aegnirssen":!0,"Arcanyst Evaluator":!0,Grimnyr:!0,"Memnyr Strategist":!0,"Cthonian Earthshakers":["Autoch-pattern bolt pistol","Plasma picks"],"Ironkin Steeljacks with Heavy Volkanite Disintegrators":["Preymark crest","Autoch-pattern bolter"],"Ironkin Steeljacks with Melee Weapons":["Preymark crest","Autoch-pattern bolter"],"Kapricus Defenders":["Armoured hull","Twin magna-coil autocannon"],"Kapricus Carrier":["Armoured hull","Magna-coil autocannon","Twin magna-coil autocannon"],"Brôkhyr Iron-master":!0,"Einhyr Champion":["Autoch-pattern combi-bolter"],Kâhl:[],"Hearthkyn Warriors":["Weavefield crest","Autoch-pattern bolt pistol","Close combat weapon","Autoch-pattern bolter"],"Brôkhyr Thunderkyn":["Close combat weapon"],"Cthonian Beserks":["Beserk"],"Einhyr Hearthguard":["Exo-armour grenade launcher"],"Hernkyn Yaegirs":["Close combat weapon"],"Hekaton Land Fortress":["Armoured wheels","MATR autocannon"],Sagitaur:["Armoured wheels","Twin bolt cannon"],"Ûthar the Destined":!0,"Hernkyn Pioneers":["Bolt Revolver","Bolt Shotgun","Magna-coil autocannon","Plasma knife"]},Necrons:Er,Orks:Mr,"Raven Guard":{"Kayvaan Shrike":!0,"Aethon Shaan":!0},Salamanders:xr,"Space Marines":{"Aggressor Squad":["Twin Power Fist"],Ancient:["Bolt Pistol","Bolt Rifle"],"Ancient in Terminator Armour":[],Apothecary:!0,"Apothecary Biologis":!0,"Assault Intercessor Squad":["Heavy Bolt Pistol","Astartes Chainsword"],"Assault Intercessors with Jump Packs":["Heavy Bolt Pistol","Astartes Chainsword"],Astraeus:["Storm Bolter","Twin Macro-Accelerator Cannon","Armoured Hull"],"Ballistus Dreadnought":!0,"Bladeguard Ancient":!0,"Bladeguard Veteran Squad":["Heavy Bolt Pistol","Master-Crafted Power Weapon"],"Brutalis Dreadnought":["Twin Icarus Ironhail Heavy Stubber"],Captain:[],"Captain in Gravis Armour":[],"Captain in Phobos Armour":!0,"Captain in Terminator Armour":[],"Captain with Jump Pack":[],"Centurion Assault Squad":["Siege Drills"],"Centurion Devastator Squad":["Centurion Fists"],Chaplain:!0,"Chaplain in Terminator Armour":["Crozius Arcanum"],"Chaplain on Bike":!0,"Chaplain with Jump pack":["Crozius Arcanum"],"Company Heroes":!0,"Desolation Squad":["Bolt Pistol","Castellan Launcher","Close Combat Weapon"],"Devastator Squad":["Bolt Pistol","Boltgun","Close Combat Weapon"],Dreadnought:[],"Drop Pod":!0,"Eliminator Squad":["Bolt Pistol","Close Combat Weapon"],"Eradicator Squad":["Bolt Pistol","Melta Rifle","Close Combat Weapon"],"Firestrike Servo Turrets":["Close Combat Weapon"],"Gladiator Lancer":["Lancer Laser Destroyer","Armoured Hull"],"Gladiator Reaper":["Tempest Bolter","Twin Heavy Onslaught Gatling Cannon","Armoured Hull"],"Gladiator Valiant":["Twin Las-Talon","Armored Hull"],"Hammerfall Bunker":["Hammerfall Missile Launcher"],"Heavy Intercessor Squad":["Heavy Bolt Rifle"],"Hellblaster Squad":["Bolt Pistol","Plasma Incinerator","Close Combat Weapon"],Impulsor:["Armoured Hull"],"Inceptor Squad":["Close Combat Weapon"],"Incursor Squad":["Bolt Pistol","Occulus Bolt Carbine","Paired Combat Blades"],"Infernus Squad":!0,"Infiltrator Squad":["Bolt Pistol","Marksman Bolt carbine","Close Combat Weapon"],"Intercessor Squad":[],"Invader ATV":["Bolt Pistol","Twin Bolt Rifle","Close Combat Weapon"],"Invictor Tactical Warsuit":["Fragstorm Grenade Launcher","Heavy Bolter","Twin Ironhail Heavy Stubber","Invictor Fist"],Judiciar:!0,"Land Raider":["Godhammer Lascannon","Twin Heavy Bolter","Armoured Tracks"],"Land Raider Crusader":["Hurricane Bolter","Twin Assault Cannon","Armoured Tracks"],"Land Raider Redeemer":["Flamestorm Cannon","Twin Assault Cannon","Armoured Tracks"],Librarian:!0,"Librarian in Phobos Armour":!0,"Librarian in Terminator Armour":["Force Weapon","Smite"],Lieutenant:[],"Lieutenant in Phobos Armour":!0,"Lieutenant in Reiver Armour":!0,"Lieutenant with Combi-weapon":!0,"Outrider Squad":["Bolt Pistol","Twin Bolt Rifle","Close Combat Weapon","Heavy Bolt Pistol","Astartes Chainsword"],"Predator Annihilator":["Predator Twin Lascannon","Armoured Tracks"],"Predator Destructor":["Predator Autocannon","Armoured Tracks"],Razorback:["Armoured Tracks"],"Redemptor Dreadnought":["Redemptor Fist"],"Reiver Squad":["Special Issue Bolt Pistol","Combat Knife","Close Combat Weapon"],Repulsor:["Hunter-Slayer Missile","Repulsor Defensive Array","Armoured Hull"],"Repulsor Executioner":["Heavy Onslaught Gatling Cannon","Repulsor Executioner Defensive Array","Twin Heavy Bolter","Twin Icarus Ironhail Heavy Stubber","Armoured Hull"],Rhino:["Armoured Tracks"],"Scout Squad":["Bolt Pistol","Boltgun","Close Combat Weapon"],"Sternguard Veteran Squad":["Sternguard Bolt Pistol","Sternguard Bolt Rifle","Close Combat Weapon"],"Storm Speeder Hailstrike":!0,"Storm Speeder Hammerstrike":!0,"Storm Speeder Thunderstrike":!0,"Stormhawk Interceptor":["Armoured Hull"],"Stormraven Gunship":["Stormstrike Missile Launcher","Armoured Hull"],"Stormtalon Gunship":["Twin Assault Cannon","Armoured Hull"],"Suppressor Squad":!0,"Tactical Squad":[],Techmarine:!0,"Terminator Assault Squad":[],"Terminator Squad":[],"Thunderhawk Gunship":["Lascannon","Twin Heavy Bolter","Armoured Hull"],"Vanguard Veteran Squad":["Bolt Pistol","Vanguard Veteran Weapon"],"Vanguard Veteran Squad with Jump Packs":["Bolt Pistol","Vanguard Veteran Weapon"],Vindicator:["Demolisher Cannon","Armoured Tracks"],Whirlwind:["Whirlwind Vengeance Launcher","Armoured Tracks"]},"Space Wolves":{"Arjac Rockfist":!0,"Bjorn the Fell-Handed":["Heavy Flamer","Trueclaw"],"Blood Claws":[],"Fenrisian Wolves":!0,"Grey Hunters":[],"Iron Priest":!0,"Logan Grimnar":!0,Murderfang:!0,"Njal Stormcaller":!0,"Ragnar Blackmane":!0,"Thunderwolf Cavalry":["Teeth and Claws","Wolf Guard Weapon"],"Ulrik the Slayer":!0,"Venerable Dreadnought":[],"Wolf Guard Battle Leader":[],"Wolf Guard Headtakers":["Heavy Bolt Pistol"],"Wolf Guard Terminators":["Storm Bolter","Master-Crafted Power Weapon"],"Wolf Priest":!0,Wulfen:["Wulfen Weapons"],"Wulfen Dreadnought":[],"Wulfen with Storm Shields":["Thunder Hammer"]},"T'au Empire":{"AX-1-0 Tiger Shark":["Twin Heavy Rail Cannon","Armoured Hull"],"Breacher Team":["Pulse Blaster","Pulse Pistol","Close Combat Weapon","Support turret"],"Broadside Battlesuits":["Crushing Bulk"],"Cadre Fireblade":["Fireblade Pulse Rifle","Close Combat Weapon"],"Commander in Enforcer Battlesuit":["Battlesuit fists"],"Commander Farsight":!0,"Commander Shadowsun":!0,"Commander in Coldstar Battlesuit":["Battlesuit fists"],"Crisis Fireknife Battlesuits":["Battlesuit Fists","Crisis Fireknife Shas’ui (Shield Drone)","Crisis Fireknife Shas’vre (Shield Drone)"],"Crisis Starscythe Battlesuits":["Battlesuit Fists","Crisis Starscythe Shas’ui (Shield Drone)","Crisis Starscythe Shas’vre (Shield Drone)"],"Crisis Sunforge Battlesuits":["Battlesuit Fists","Crisis Sunforge Shas’ui (Shield Drone)","Crisis Sunforge Shas’vre (Shield Drone)"],Darkstrider:!0,Devilfish:["Accelerator Burst Cannon","Armoured Hull"],Ethereal:["Honour Stave"],"Firesight Team":!0,"Ghostkeel Battlesuit":["Ghostkeel Fists"],"Hammerhead Gunship":["Armoured Hull"],"Kroot Carnivores":["Close Combat Weapon","Kroot Pistol","Kroot Pistol","Kroot Pistol","Kroot Pistol","Kroot Pistol","Kroot Pistol","Kroot Pistol"],"Kroot Farstalkers":["Ritual Blade","Close Combat Weapon","Ripping Fangs"],"Kroot Flesh Shaper":!0,"Kroot Hounds":!0,"Kroot Lone Spear":["Kalamandra's Bite","Close Combat Weapon"],"Kroot Lone-Spear":["Kalamandra's Bite","Close Combat Weapon"],"Kroot Trail Shaper":!0,"Kroot War Shaper":["Kroot Pistol","Shaper's blade"],"Krootox Riders":["Close Combat Weapon","Krootox Fists"],"Krootox rampagers":!0,Manta:!0,"Pathfinder Team":["Pulse Carbine","Pulse Pistol","Close Combat Weapon","Recon droneDrone burst cannon","Drone burst cannon"],Piranha:["Twin Pulse Carbine","Armoured hull"],"Razorshark Strike Fighter":["Accelerator Burst Cannon","Quad Ion Turret","Armoured Hull"],"Riptide Battlesuit":["Riptide Fists"],"Sky Ray Gunship":["Seeker missile Rack","Armoured Hull"],"Stealth Battlesuits":["Battlesuit Fists","Stealth Shas’ui","Battlesuit support system","Homing beacon"],Stormsurge:["Cluster Rocket System","Destroyer Missiles","Thunderous Footfalls"],"Strike Team":["Pulse Rifle","Close Combat Weapon","Support turret"],"Sun Shark Bomber":["Twin Ion Rifle","Armoured Hull"],"Ta'unar Supremacy Armour":["Crushing Feet","Burst Cannon","Smart Missile System"],"Tidewall Droneport":!0,"Tidewall Gunrig":!0,"Tidewall Shieldline":[],"Tiger Shark":["Armoured Hull"],"Vespid Stingwings":["Stingwing Claws"]},"Thousand Sons":{Ahriman:!0,"Blue Horrors":!0,"Chaos Land Raider":["Soulshatter Lascannon"],"Chaos Predator Annihilator":["Predator Twin Lascannon","Armoured Tracks"],"Chaos Predator Destructor":["Predator Autocannon","Armoured Tracks"],"Chaos Rhino":["Armoured Tracks"],"Chaos Spawn":!0,"Chaos Vindicator":["Demolisher Cannon","Armoured Tracks"],"Daemon Prince of Tzeentch":!0,"Daemon Prince of Tzeentch with Wings":!0,Defiler:["Defiler Cannon","Defiler Claws"],"Exalted Sorcerer":["Inferno Bolt Pistol","Astral Blast","Force Weapon"],"Exalted Sorcerer on Disc of Tzeentch":["Arcane Fire","Inferno Bolt Pistol","Force Weapon"],Flamers:!0,Forgefiend:[],Helbrute:[],Heldrake:["Heldrake Claws"],"Infernal Master":!0,"Kairos Fateweaver":!0,"Lord of Change":["Bolt of Change","Staff of Tzeentch"],"Magnus the Red":!0,Maulerfiend:["Maulerfiend Fists"],"Mutalith Vortex Beast":!0,"Pink Horrors":["Coruscating Pink Flames","Coruscating Blue Flames","Coruscating Yellow Flames","Pink Claws","Blue Claws","Yellow Claws"],"Rubric Marines":["Malefic Curse"],"Scarab Occult Terminators":["Malefic Curse","Force Weapon"],Screamers:!0,"Sekhetar Robots":["Heavy Warpflamer","Hellfyre Missile Rack","Close Combat Weapon"],Sorcerer:["Pandaemonic Delusion","Inferno Bolt Pistol","Force Weapon"],"Sorcerer in Terminator Armour":["Gaze of Hate"],"Tzaangor Enlightened":[],"Tzaangor Enlightened with Fatecaster Greatbows":!0,"Tzaangor Shaman":!0,Tzaangors:[]},Tyranids:Ir,Ultramarines:vr,"White Scars":{"Kor'sarro Khan":!0},"Agents of the Imperium":{"Callidus Assassin":!0,"Corvus Blackstar":["Twin Assault Cannon","Armoured Hull"],"Culexus Assassin":!0,"Deathwatch Kill Team":[],"Eversor Assassin":!0,"Exaction Squad":["Arbites Shotpistol","Close Combat Weapon","Mechanical Bite","Nuncio-Aquila"],"Grey Knights Terminator Squad":["Nemesis Force Weapon"],"Imperial Navy Breachers":["Close Combat Weapon","Endurant Shield"],"Imperial Rhino":["Storm Bolter","Armoured Tracks"],Inquisitor:["Blessed Wardings"],"Inquisitor Coteaz":!0,"Inquisitor Draxus":!0,"Inquisitor Greyfax":!0,"Inquisitorial Agents":["Agent Firearm","Agent Melee Weapon"],"Inquisitorial Chimera":["Armoured Tracks"],"Ministorum Priest":[],Navigator:!0,"Rogue Trader Entourage":!0,Sanctifiers:[],"Sisters of Battle Immolator":["Heavy Bolter","Armoured Tracks"],"Sisters of Battle Squad":["Bolt Pistol","Close Combat Weapon"],"Subductor Squad":["Arbites Shotpistol","Shock maul","Mechanical Bite","Nuncio Aquila"],"Vigilant Squad":["Arbites Shotpistol","Close Combat Weapon","Mechanical Bite","Nuncio-Aquila"],"Vindicare Assassin":!0,"Voidsmen-at-Arms":!0,"Watch Captain Artemis":!0,"Watch Master":!0}};function te(t,e){const[s,u]=Lt(()=>{try{const n=localStorage.getItem(t);return n?JSON.parse(n):e}catch(n){return e}});return Bt(()=>{try{localStorage.setItem(t,JSON.stringify(s))}catch(n){}},[t,s]),[s,u]}function He({id:t,active:e,label:s,onClick:u}){return x("button",{class:`tab ${e?"active":""}`,onClick:u,children:s})}function Dr(){const[t,e]=te("tab","input"),[s,u]=te("text",""),[n,f]=te("hide",!1),[m,o]=te("combine",!1),[l,a]=te("multiline",!1),[c,r]=te("colorMode","faction"),[i,h]=te("colors",{unit:"#ffffff",subunit:"#808080",wargear:"#ffffff",points:"#ffff00",header:"#ffff00"}),[d,A]=te("format","discordCompact"),p=me(()=>{if(!s.trim())return null;const T=s.split(/\r?\n/),k=Cr(T),E={GW_APP:cr,WTC_COMPACT:ir,WTC:ur,NR_GW:mr,NRNR:hr,LF:yr}[k];if(!E)return null;try{return E(T)}catch(I){return null}},[s]),C=me(()=>p?Ar(p):null,[p]),S=me(()=>!p||!C?"":_t(p,!1,C,!1,U,!1,!1).plainText,[p,C]);me(()=>!p||!C?"":_t(p,!0,C,n,U,!0,m).plainText,[p,C,n,m]);const[b,g]=Lt(""),y=me(()=>{var k;const T=(k=Te!=null?Te:Ie.AnsiUp)!=null?k:ft;try{return new T}catch(E){return new ft}},[]);Bt(()=>{if(!p||!C){g("");return}let T="";const k={colorMode:c,colors:i};switch(d){case"discordCompact":T=j(p,!1,!0,C,n,U,m,k);break;case"discordExtended":T=j(p,!1,!1,C,n,U,m,k);break;case"plainText":T=j(p,!0,!0,C,n,U,m,k);break;case"plainTextExtended":T=j(p,!0,!1,C,n,U,m,k);break;default:T=j(p,!1,!0,C,n,U,m,k)}g(T)},[p,C,n,m,c,i,l,d]);const _=me(()=>y.ansi_to_html(b),[b,y]);function w(T){var I,M;if(!T||!p||!C){(I=navigator.clipboard)==null||I.writeText(T||"");return}const k={colorMode:c,colors:i,forcePalette:!0};let E="";switch(d){case"discordCompact":E=j(p,!1,!0,C,n,U,m,k);break;case"discordExtended":E=j(p,!1,!1,C,n,U,m,k);break;case"plainText":E=j(p,!0,!0,C,n,U,m,k);break;case"plainTextExtended":E=j(p,!0,!1,C,n,U,m,k);break;default:E=j(p,!1,!0,C,n,U,m,k)}(M=navigator.clipboard)==null||M.writeText(E)}return x("div",{class:"container",children:[x("header",{children:x("div",{class:"row",style:{justifyContent:"space-between",alignItems:"center"},children:[x("strong",{children:"40k Compactor"}),x("span",{class:"pill",children:"Mobile"})]})}),x("div",{class:"screen",children:[t==="input"&&x("div",{class:"section",children:[x("textarea",{placeholder:"Paste your list here",value:s,onInput:T=>u(T.currentTarget.value)}),x("div",{class:"row",style:{marginTop:"6px",justifyContent:"space-between"},children:[x("span",{class:"pill",children:[s.length," chars"]}),x("button",{class:"btn",onClick:()=>u(""),children:"Clear"})]})]}),t==="compact"&&x("div",{class:"section",children:[x("div",{class:"row",style:{marginBottom:"6px",justifyContent:"space-between"},children:x("label",{children:["Output:",x("select",{value:d,onChange:T=>A(T.target.value),style:{marginLeft:"6px"},children:[x("option",{value:"discordCompact",children:"Discord (Compact)"}),x("option",{value:"discordExtended",children:"Discord (Extended)"}),x("option",{value:"plainText",children:"Plain Text"}),x("option",{value:"plainTextExtended",children:"Plain Text (extended)"})]})]})}),x("div",{class:"row",style:{marginBottom:"6px",justifyContent:"space-between"},children:[x("label",{children:[x("input",{type:"checkbox",checked:n,onChange:T=>f(T.target.checked)})," Hide Subunits"]}),x("label",{children:[x("input",{type:"checkbox",checked:m,onChange:T=>o(T.target.checked)})," Combine like units"]}),x("label",{children:[x("input",{id:"multilineHeaderCheckbox",type:"checkbox",checked:l,onChange:T=>a(T.target.checked)})," Multiline Header"]})]}),x("div",{class:"row",style:{gap:"10px",alignItems:"center",marginBottom:"6px"},children:[x("label",{children:[x("input",{type:"radio",name:"colorMode",value:"none",checked:c==="none",onChange:()=>r("none")}),x("span",{style:{marginLeft:"6px"},children:"No color"})]}),x("label",{children:[x("input",{type:"radio",name:"colorMode",value:"custom",checked:c==="custom",onChange:()=>r("custom")}),x("span",{style:{marginLeft:"6px"},children:"Custom"})]}),x("label",{children:[x("input",{type:"radio",name:"colorMode",value:"faction",checked:c==="faction",onChange:()=>r("faction")}),x("span",{style:{marginLeft:"6px"},children:"Faction Color"})]})]}),c==="custom"&&x("div",{class:"grid2 section",children:["unit","subunit","wargear","points","header"].map(T=>x("label",{children:[T," color",x("input",{id:`${T}Color`,type:"color",value:i[T],onChange:k=>h(We(ce({},i),{[T]:k.target.value})),style:{marginLeft:"6px"}})]}))}),x("div",{class:"outbox",id:"markdownPreviewOutput",dangerouslySetInnerHTML:{__html:_}}),x("div",{class:"row",style:{marginTop:"6px",justifyContent:"flex-end"},children:x("button",{class:"btn",onClick:()=>w(b),children:"Copy"})})]}),t==="full"&&x("div",{class:"section",children:[x("div",{class:"outbox",children:S}),x("div",{class:"row",style:{marginTop:"6px",justifyContent:"flex-end"},children:x("button",{class:"btn",onClick:()=>w(S),children:"Copy"})})]})]}),x("nav",{class:"tabs",children:[x(He,{id:"input",active:t==="input",label:"Input",onClick:()=>e("input")}),x(He,{id:"compact",active:t==="compact",label:"Compact",onClick:()=>e("compact")}),x(He,{id:"full",active:t==="full",label:"Full",onClick:()=>e("full")})]})]})}er(x(Dr,{}),document.getElementById("app"));
